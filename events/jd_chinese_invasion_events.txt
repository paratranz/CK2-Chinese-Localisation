namespace = JD
character_event = {
    id = JD.10100
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    trigger = {
        FROM = {
            is_offmap_tag = offmap_china
        }
        war = no
        NOT = {
            has_offmap_tmp_flag = launching_invasion_of_the_west
        }
        china_is_fine_trigger = yes
        NOR = {
            has_game_rule = {
                name = chinese_invasions
                value = none
            }
            has_game_rule = {
                name = chinese_invasions
                value = adventurers_only
            }
        }
    }
    immediate = {
        set_offmap_tmp_flag = launching_invasion_of_the_west
        save_event_target_as = the_protector_general
        if = {
            limit = {
                event_target:the_protector_general = {
                    is_landed = yes
                }
            }
            set_offmap_tmp_flag = WP_is_on_map
        }
        if = {
            limit = {
                event_target:the_protector_general = {
                    is_landed = no
                }
            }
            set_offmap_tmp_flag = WP_is_not_on_map
        }
        if = {
            limit = {
                OR = {
                    NOT = {
                        has_offmap_tmp_flag = pretender_chinese_empire_war_cooldown
                    }
                    had_offmap_tmp_flag = {
                        flag = pretender_chinese_empire_war_cooldown
                        years = 150
                    }
                }
                any_playable_ruler = {
                    primary_title = {
                        has_title_flag = rebel_general_title
                    }
                }
            }
            set_offmap_tmp_flag = pretender_chinese_empire_exists
        }
        random_list = {
            100 = {
                trigger = {
                    has_offmap_tmp_flag = pretender_chinese_empire_exists
                }
                modifier = {
                    factor = 2
                    has_offmap_tmp_flag = WP_is_on_map
                }
                modifier = {
                    factor = 1.5
                    has_status = china_golden_age
                }
                any_playable_ruler = {
                    limit = {
                        primary_title = {
                            has_title_flag = rebel_general_title
                        }
                    }
                    save_event_target_as = chinese_invasion_target
                }
                war = {
                    casus_belli = dismantle_pretender_china_cb
                    target = event_target:chinese_invasion_target
                }
                if = {
                    limit = {
                        has_offmap_tmp_flag = WP_is_on_map
                    }
                    random_realm_province = {
                        limit = {
                            is_capital = yes
                        }
                        save_event_target_as = chinese_invasion_spawn_point_province
                    }
                }
                if = {
                    random_list = {
                        10 = {
                            1408 = {
                                save_event_target_as = chinese_invasion_spawn_point_province
                            }
                        }
                        10 = {
                            1448 = {
                                save_event_target_as = chinese_invasion_spawn_point_province
                            }
                        }
                        10 = {
                            1513 = {
                                save_event_target_as = chinese_invasion_spawn_point_province
                            }
                        }
                        10 = {
                            1450 = {
                                save_event_target_as = chinese_invasion_spawn_point_province
                            }
                        }
                        10 = {
                            1446 = {
                                save_event_target_as = chinese_invasion_spawn_point_province
                            }
                        }
                        10 = {
                            1449 = {
                                save_event_target_as = chinese_invasion_spawn_point_province
                            }
                        }
                    }
                }
                log = "-------------------------------------"
                log = "China Logging:"
                log = "China declared dismantle pretender on {chinese_invasion_target.GetBestName}"
                log = "Current status = {From.Offmap.GetStatus}. Current policy = {From.Offmap.GetPolicy}."
                log = "-------------------------------------"
                clr_offmap_tmp_flag = pretender_chinese_empire_exists
                clr_offmap_tmp_flag = pretender_chinese_empire_war_cooldown
                any_player = {
                    limit = {
                        has_offmap_news_enabled = offmap_china
                        is_within_diplo_range = ROOT
                    }
                    narrative_event = {
                        id = JD.60208
                        days = 1
                    }
                }
            }
            100 = {
                trigger = {
                    NOT = {
                        has_offmap_tmp_flag = pretender_chinese_empire_exists
                    }
                    NOT = {
                        has_offmap_tmp_flag = tributary_invasion_fired
                    }
                    OR = {
                        AND = {
                            NOT = {
                                has_policy = china_expansionist
                            }
                            any_independent_ruler = {
                                valid_offmap_china_target_location = yes
                                valid_offmap_china_target = yes
                                NOT = {
                                    num_of_count_titles_in_realm = 20
                                }
                            }
                            any_independent_ruler = num_of_count_titles_in_realm > 0
                        }
                    }
                    AND = {
                        has_policy = china_expansionist
                        any_independent_ruler = {
                            valid_offmap_china_target_location = yes
                            num_of_count_titles_in_realm = 15
                            valid_offmap_china_target = yes
                        }
                    }
                }
            }
            modifier = {
                factor = 1.5
                has_offmap_tmp_flag = WP_is_not_on_map
            }
            modifier = {
                factor = 1.5
                OR = {
                    china_is_stable_expansionist_trigger = yes
                    china_is_golden_age_open_trigger = yes
                }
            }
            modifier = {
                factor = 10
                OR = {
                    AND = {
                        china_is_stable_open_trigger = yes
                        NOT = {
                            any_playable_ruler = {
                                count = 4
                                is_tributary = {
                                    suzerain = ROOT
                                }
                            }
                        }
                    }
                    AND = {
                        china_is_golden_age_open_trigger = yes
                        NOT = {
                            any_playable_ruler = {
                                count = 9
                                is_tributary = {
                                    suzerain = ROOT
                                }
                            }
                        }
                    }
                }
            }
            modifier = {
                factor = 2
                has_status = china_golden_age
            }
            random_list = {
                10 = {
                    trigger = {
                        OR = {
                            NOT = {
                                has_policy = china_expansionist
                            }
                            AND = {
                                has_policy = china_expansionist
                                NOT = {
                                    any_independent_ruler = {
                                        valid_offmap_china_target_location = yes
                                        num_of_count_titles_in_realm = 15
                                        valid_offmap_china_target = yes
                                    }
                                }
                            }
                        }
                    }
                    random_independent_ruler = {
                        limit = {
                            valid_offmap_china_target_location = yes
                            valid_offmap_china_target = yes
                            NOT = {
                                num_of_count_titles_in_realm = 20
                            }
                        }
                        limit = num_of_count_titles_in_realm > 0
                    }
                    save_event_target_as = chinese_invasion_target
                }
                random_independent_ruler = {
                    limit = {
                        valid_offmap_china_target_location = yes
                        valid_offmap_china_target = yes
                        NOT = {
                            num_of_count_titles_in_realm = 20
                        }
                        num_of_count_titles_in_realm > 0 NOT = {
                            has_character_modifier = china_supply_horses
                        }
                    }
                    save_event_target_as = chinese_invasion_target
                }
                random_independent_ruler = {
                    limit = {
                        valid_offmap_china_target_location = yes
                        valid_offmap_china_target = yes
                        NOT = {
                            has_character_modifier = china_supply_horses
                        }
                        has_character_modifier = china_raid_active
                    }
                    save_event_target_as = chinese_invasion_target
                }
                random_independent_ruler = {
                    limit = {
                        valid_offmap_china_target = yes
                        valid_offmap_china_target_location = yes
                        NOT = {
                            num_of_count_titles_in_realm = 20
                        }
                    }
                    limit = num_of_count_titles_in_realm > 0
                }
                save_event_target_as = chinese_invasion_target
            }
            random_independent_ruler = {
                limit = {
                    valid_offmap_china_target = yes
                    valid_offmap_china_target_location = yes
                    NOT = {
                        num_of_count_titles_in_realm = 20
                    }
                    num_of_count_titles_in_realm > 0 NOT = {
                        has_character_modifier = china_supply_horses
                    }
                }
                save_event_target_as = chinese_invasion_target
            }
            random_independent_ruler = {
                limit = {
                    valid_offmap_china_target = yes
                    valid_offmap_china_target_location = yes
                    NOT = {
                        num_of_count_titles_in_realm = 20
                    }
                    num_of_count_titles_in_realm > 0 NOT = {
                        has_character_modifier = china_supply_horses
                    }
                    has_character_modifier = china_raid_active
                }
                save_event_target_as = chinese_invasion_target
            }
            random_independent_ruler = {
                limit = {
                    valid_offmap_china_target = yes
                    valid_offmap_china_target_location = yes
                    NOT = {
                        num_of_count_titles_in_realm = 20
                    }
                    num_of_count_titles_in_realm > 0 liked_by_offmap = {
                        type = offmap_china
                    }
                    NOT = {
                        disliked_by_offmap = {
                            type = offmap_china
                        }
                    }
                }
                save_event_target_as = chinese_invasion_target
            }
            random_independent_ruler = {
                limit = {
                    valid_offmap_china_target = yes
                    valid_offmap_china_target_location = yes
                    NOT = {
                        num_of_count_titles_in_realm = 20
                    }
                    num_of_count_titles_in_realm > 0 liked_by_offmap = {
                        type = offmap_china
                    }
                    NOT = {
                        disliked_by_offmap = {
                            type = offmap_china
                        }
                    }
                    NOT = {
                        has_character_modifier = china_supply_horses
                    }
                }
                save_event_target_as = chinese_invasion_target
            }
            random_independent_ruler = {
                limit = {
                    valid_offmap_china_target = yes
                    valid_offmap_china_target_location = yes
                    NOT = {
                        num_of_count_titles_in_realm = 20
                    }
                    num_of_count_titles_in_realm > 0 liked_by_offmap = {
                        type = offmap_china
                    }
                    NOT = {
                        disliked_by_offmap = {
                            type = offmap_china
                        }
                    }
                    NOT = {
                        has_character_modifier = china_supply_horses
                    }
                    has_character_modifier = china_raid_active
                }
                save_event_target_as = chinese_invasion_target
            }
            random_independent_ruler = {
                limit = {
                    valid_offmap_china_target_location_tributary_chain = yes
                    valid_offmap_china_target = yes
                    NOT = {
                        num_of_count_titles_in_realm = 20
                    }
                }
                limit = num_of_count_titles_in_realm > 0
            }
            save_event_target_as = chinese_invasion_target
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target_location_tributary_chain = yes
                valid_offmap_china_target = yes
                NOT = {
                    num_of_count_titles_in_realm = 20
                }
                num_of_count_titles_in_realm > 0 NOT = {
                    has_character_modifier = china_supply_horses
                }
            }
            save_event_target_as = chinese_invasion_target
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target_location_tributary_chain = yes
                valid_offmap_china_target = yes
                NOT = {
                    has_character_modifier = china_supply_horses
                }
                has_character_modifier = china_raid_active
            }
            save_event_target_as = chinese_invasion_target
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target = yes
                valid_offmap_china_target_location_tributary_chain = yes
                NOT = {
                    num_of_count_titles_in_realm = 20
                }
            }
            limit = num_of_count_titles_in_realm > 0
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target = yes
            valid_offmap_china_target_location_tributary_chain = yes
            NOT = {
                num_of_count_titles_in_realm = 20
            }
            num_of_count_titles_in_realm > 0 NOT = {
                has_character_modifier = china_supply_horses
            }
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target = yes
            valid_offmap_china_target_location_tributary_chain = yes
            NOT = {
                num_of_count_titles_in_realm = 20
            }
            num_of_count_titles_in_realm > 0 NOT = {
                has_character_modifier = china_supply_horses
            }
            has_character_modifier = china_raid_active
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target = yes
            valid_offmap_china_target_location_tributary_chain = yes
            NOT = {
                num_of_count_titles_in_realm = 20
            }
            num_of_count_titles_in_realm > 0 liked_by_offmap = {
                type = offmap_china
            }
            NOT = {
                disliked_by_offmap = {
                    type = offmap_china
                }
            }
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target = yes
            valid_offmap_china_target_location_tributary_chain = yes
            NOT = {
                num_of_count_titles_in_realm = 20
            }
            num_of_count_titles_in_realm > 0 liked_by_offmap = {
                type = offmap_china
            }
            NOT = {
                disliked_by_offmap = {
                    type = offmap_china
                }
            }
            NOT = {
                has_character_modifier = china_supply_horses
            }
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target = yes
            valid_offmap_china_target_location_tributary_chain = yes
            NOT = {
                num_of_count_titles_in_realm = 20
            }
            num_of_count_titles_in_realm > 0 liked_by_offmap = {
                type = offmap_china
            }
            NOT = {
                disliked_by_offmap = {
                    type = offmap_china
                }
            }
            NOT = {
                has_character_modifier = china_supply_horses
            }
            has_character_modifier = china_raid_active
        }
        save_event_target_as = chinese_invasion_target
    }
}
10 = {
    trigger = {
        has_policy = china_expansionist
        any_independent_ruler = {
            valid_offmap_china_target_location = yes
            num_of_count_titles_in_realm = 15
            valid_offmap_china_target = yes
        }
    }
    modifier = {
        factor = 10
        china_is_golden_age_expansionist_trigger = yes
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location = yes
            num_of_count_titles_in_realm = 15
            valid_offmap_china_target = yes
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location = yes
            num_of_count_titles_in_realm = 15
            valid_offmap_china_target = yes
            NOT = {
                has_character_modifier = china_supply_horses
            }
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location = yes
            num_of_count_titles_in_realm = 15
            valid_offmap_china_target = yes
            NOT = {
                has_character_modifier = china_supply_horses
            }
            has_character_modifier = china_raid_active
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location = yes
            num_of_count_titles_in_realm = 20
            valid_offmap_china_target = yes
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location = yes
            num_of_count_titles_in_realm = 20
            valid_offmap_china_target = yes
            NOT = {
                has_character_modifier = china_supply_horses
            }
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location = yes
            num_of_count_titles_in_realm = 20
            valid_offmap_china_target = yes
            NOT = {
                has_character_modifier = china_supply_horses
            }
            has_character_modifier = china_raid_active
        }
        save_event_target_as = chinese_invasion_target
    }
    if = {
        limit = {
            has_policy = china_expansionist
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target = yes
                valid_offmap_china_target_location = yes
                num_of_count_titles_in_realm = 20
                liked_by_offmap = {
                    type = offmap_china
                }
                NOT = {
                    disliked_by_offmap = {
                        type = offmap_china
                    }
                }
            }
            save_event_target_as = chinese_invasion_target
        }
    }
    if = {
        limit = {
            has_policy = china_expansionist
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target = yes
                valid_offmap_china_target_location = yes
                num_of_count_titles_in_realm = 20
                liked_by_offmap = {
                    type = offmap_china
                }
                NOT = {
                    disliked_by_offmap = {
                        type = offmap_china
                    }
                }
                NOT = {
                    has_character_modifier = china_supply_horses
                }
            }
            save_event_target_as = chinese_invasion_target
        }
    }
    if = {
        limit = {
            has_policy = china_expansionist
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target = yes
                valid_offmap_china_target_location = yes
                num_of_count_titles_in_realm = 20
                liked_by_offmap = {
                    type = offmap_china
                }
                NOT = {
                    disliked_by_offmap = {
                        type = offmap_china
                    }
                }
                NOT = {
                    has_character_modifier = china_supply_horses
                }
                has_character_modifier = china_raid_active
            }
            save_event_target_as = chinese_invasion_target
        }
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location_tributary_chain = yes
            num_of_count_titles_in_realm = 15
            valid_offmap_china_target = yes
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location_tributary_chain = yes
            num_of_count_titles_in_realm = 15
            valid_offmap_china_target = yes
            NOT = {
                has_character_modifier = china_supply_horses
            }
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location_tributary_chain = yes
            num_of_count_titles_in_realm = 15
            valid_offmap_china_target = yes
            NOT = {
                has_character_modifier = china_supply_horses
            }
            has_character_modifier = china_raid_active
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location_tributary_chain = yes
            num_of_count_titles_in_realm = 20
            valid_offmap_china_target = yes
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location_tributary_chain = yes
            num_of_count_titles_in_realm = 20
            valid_offmap_china_target = yes
            NOT = {
                has_character_modifier = china_supply_horses
            }
        }
        save_event_target_as = chinese_invasion_target
    }
    random_independent_ruler = {
        limit = {
            valid_offmap_china_target_location_tributary_chain = yes
            num_of_count_titles_in_realm = 20
            valid_offmap_china_target = yes
            NOT = {
                has_character_modifier = china_supply_horses
            }
            has_character_modifier = china_raid_active
        }
        save_event_target_as = chinese_invasion_target
    }
    if = {
        limit = {
            has_policy = china_expansionist
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target = yes
                valid_offmap_china_target_location_tributary_chain = yes
                num_of_count_titles_in_realm = 20
                liked_by_offmap = {
                    type = offmap_china
                }
                NOT = {
                    disliked_by_offmap = {
                        type = offmap_china
                    }
                }
            }
            save_event_target_as = chinese_invasion_target
        }
    }
    if = {
        limit = {
            has_policy = china_expansionist
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target = yes
                valid_offmap_china_target_location_tributary_chain = yes
                num_of_count_titles_in_realm = 20
                liked_by_offmap = {
                    type = offmap_china
                }
                NOT = {
                    disliked_by_offmap = {
                        type = offmap_china
                    }
                }
                NOT = {
                    has_character_modifier = china_supply_horses
                }
            }
            save_event_target_as = chinese_invasion_target
        }
    }
    if = {
        limit = {
            has_policy = china_expansionist
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target = yes
                valid_offmap_china_target_location_tributary_chain = yes
                num_of_count_titles_in_realm = 20
                liked_by_offmap = {
                    type = offmap_china
                }
                NOT = {
                    disliked_by_offmap = {
                        type = offmap_china
                    }
                }
                NOT = {
                    has_character_modifier = china_supply_horses
                }
                has_character_modifier = china_raid_active
            }
            save_event_target_as = chinese_invasion_target
        }
    }
}
event_target:chinese_invasion_target = {
    character_event = {
        id = JD.10130
    }
}
100 = {
    trigger = {
        NOT = {
            has_offmap_tmp_flag = pretender_chinese_empire_exists
        }
        NOT = {
            has_offmap_tmp_flag = major_invasion_fired
        }
        NOT = {
            has_offmap_tmp_flag = attacked_small_neighbor
        }
        NOT = {
            has_game_rule = {
                name = chinese_invasions
                value = no_major_invasions
            }
        }
        OR = {
            AND = {
                NOT = {
                    completely_controls = d_jiuquan
                }
                d_jiuquan = {
                    any_direct_de_jure_vassal_title = {
                        holder_scope = {
                            top_liege = {
                                valid_offmap_china_target = yes
                            }
                        }
                    }
                }
            }
            AND = {
                has_policy = china_expansionist
                OR = {
                    AND = {
                        has_offmap_tmp_flag = WP_is_on_map
                        any_independent_ruler = {
                            valid_offmap_china_target_location = yes
                            is_nomadic = no
                            num_of_count_titles_in_realm = 15
                            NOT = {
                                num_of_count_titles_in_realm = 30
                            }
                            valid_offmap_china_target = yes
                        }
                    }
                    AND = {
                        has_offmap_tmp_flag = WP_is_not_on_map
                        any_independent_ruler = {
                            capital_scope = {
                                region = custom_eastern_edge_of_map
                            }
                            is_nomadic = no
                            num_of_count_titles_in_realm = 10
                            NOT = {
                                num_of_count_titles_in_realm = 40
                            }
                            valid_offmap_china_target = yes
                        }
                    }
                }
            }
            AND = {
                has_policy = china_expansionist
                OR = {
                    AND = {
                        has_offmap_tmp_flag = WP_is_on_map
                        any_independent_ruler = {
                            valid_offmap_china_target_location = yes
                            is_nomadic = no
                            num_of_count_titles_in_realm = 20
                            valid_offmap_china_target = yes
                        }
                    }
                    AND = {
                        has_offmap_tmp_flag = WP_is_not_on_map
                        any_independent_ruler = {
                            capital_scope = {
                                region = custom_eastern_edge_of_map
                            }
                            is_nomadic = no
                            num_of_count_titles_in_realm = 20
                            valid_offmap_china_target = yes
                        }
                    }
                }
            }
            AND = {
                has_offmap_tmp_flag = WP_is_on_map
                any_neighbor_independent_ruler = {
                    valid_offmap_china_target_location = yes
                    valid_offmap_china_target = yes
                    higher_real_tier_than = BARON
                    is_nomadic = no
                }
            }
        }
    }
    modifier = {
        factor = 1.5
        has_status = china_golden_age
    }
    modifier = {
        factor = 3
        has_policy = china_expansionist
    }
    modifier = {
        factor = 4
        china_is_golden_age_expansionist_trigger = yes
    }
    modifier = {
        factor = 2
        has_offmap_tmp_flag = WP_is_not_on_map
        OR = {
            has_status = china_golden_age
            has_policy = china_expansionist
        }
    }
    random_list = {
        100 = {
            trigger = {
                NOT = {
                    completely_controls = d_jiuquan
                }
                d_jiuquan = {
                    any_direct_de_jure_vassal_title = {
                        holder_scope = {
                            top_liege = {
                                valid_offmap_china_target = yes
                            }
                        }
                    }
                }
            }
            d_jiuquan = {
                any_direct_de_jure_vassal_title = {
                    add_claim = ROOT
                }
                random_direct_de_jure_vassal_title = {
                    limit = {
                        holder_scope = {
                            top_liege = {
                                valid_offmap_china_target = yes
                            }
                        }
                    }
                    holder_scope = {
                        top_liege = {
                            save_event_target_as = chinese_invasion_target
                        }
                    }
                }
            }
            set_offmap_tmp_flag = should_claim_all_titles_war
        }
        50 = {
            trigger = {
                has_policy = china_expansionist
                OR = {
                    AND = {
                        has_offmap_tmp_flag = WP_is_on_map
                        any_independent_ruler = {
                            valid_offmap_china_target_location = yes
                            is_nomadic = no
                            num_of_count_titles_in_realm = 15
                            NOT = {
                                num_of_count_titles_in_realm = 30
                            }
                            valid_offmap_china_target = yes
                        }
                    }
                    AND = {
                        has_offmap_tmp_flag = WP_is_not_on_map
                        any_independent_ruler = {
                            capital_scope = {
                                region = custom_eastern_edge_of_map
                            }
                            is_nomadic = no
                            num_of_count_titles_in_realm = 10
                            NOT = {
                                num_of_count_titles_in_realm = 40
                            }
                            valid_offmap_china_target = yes
                        }
                    }
                }
            }
            if = {
                limit = {
                    has_offmap_tmp_flag = WP_is_on_map
                }
                random_independent_ruler = {
                    limit = {
                        valid_offmap_china_target_location = yes
                        is_nomadic = no
                        num_of_count_titles_in_realm = 15
                        NOT = {
                            num_of_count_titles_in_realm = 30
                        }
                        valid_offmap_china_target = yes
                    }
                    save_event_target_as = chinese_invasion_target
                }
            }
            if = {
                limit = {
                    has_offmap_tmp_flag = WP_is_on_map
                }
                random_neighbor_independent_ruler = {
                    limit = {
                        valid_offmap_china_target_location = yes
                        is_nomadic = no
                        num_of_count_titles_in_realm = 15
                        NOT = {
                            num_of_count_titles_in_realm = 30
                        }
                        valid_offmap_china_target = yes
                    }
                    save_event_target_as = chinese_invasion_target
                }
            }
            if = {
                limit = {
                    has_offmap_tmp_flag = WP_is_not_on_map
                }
                random_independent_ruler = {
                    limit = {
                        capital_scope = {
                            region = custom_eastern_edge_of_map
                        }
                        is_nomadic = no
                        num_of_count_titles_in_realm = 10
                        NOT = {
                            num_of_count_titles_in_realm = 40
                        }
                        valid_offmap_china_target = yes
                    }
                    save_event_target_as = chinese_invasion_target
                }
            }
            set_offmap_tmp_flag = start_submission_war
        }
        10 = {
            trigger = {
                has_policy = china_expansionist
                OR = {
                    AND = {
                        has_offmap_tmp_flag = WP_is_on_map
                        any_independent_ruler = {
                            valid_offmap_china_target_location = yes
                            is_nomadic = no
                            num_of_count_titles_in_realm = 20
                            valid_offmap_china_target = yes
                        }
                    }
                    AND = {
                        has_offmap_tmp_flag = WP_is_not_on_map
                        any_independent_ruler = {
                            capital_scope = {
                                region = custom_eastern_edge_of_map
                            }
                            is_nomadic = no
                            num_of_count_titles_in_realm = 20
                            valid_offmap_china_target = yes
                        }
                    }
                }
            }
            modifier = {
                factor = 2
                has_status = china_golden_age
            }
            if = {
                limit = {
                    has_offmap_tmp_flag = WP_is_on_map
                }
                random_independent_ruler = {
                    limit = {
                        valid_offmap_china_target_location = yes
                        is_nomadic = no
                        num_of_count_titles_in_realm = 20
                        valid_offmap_china_target = yes
                    }
                    save_event_target_as = chinese_invasion_target
                }
            }
            if = {
                limit = {
                    has_offmap_tmp_flag = WP_is_on_map
                }
                random_independent_ruler = {
                    limit = {
                        valid_offmap_china_target_location = yes
                        is_nomadic = no
                        num_of_count_titles_in_realm = 20
                        valid_offmap_china_target = yes
                        disliked_by_offmap = {
                            type = offmap_china
                        }
                        NOT = {
                            liked_by_offmap = {
                                type = offmap_china
                            }
                        }
                    }
                    save_event_target_as = chinese_invasion_target
                }
            }
            if = {
                limit = {
                    has_offmap_tmp_flag = WP_is_on_map
                }
                random_neighbor_independent_ruler = {
                    limit = {
                        is_nomadic = no
                        num_of_count_titles_in_realm = 20
                        valid_offmap_china_target = yes
                    }
                    save_event_target_as = chinese_invasion_target
                }
            }
            if = {
                limit = {
                    has_offmap_tmp_flag = WP_is_on_map
                }
                random_neighbor_independent_ruler = {
                    limit = {
                        is_nomadic = no
                        num_of_count_titles_in_realm = 20
                        valid_offmap_china_target = yes
                        disliked_by_offmap = {
                            type = offmap_china
                        }
                        NOT = {
                            liked_by_offmap = {
                                type = offmap_china
                            }
                        }
                    }
                    save_event_target_as = chinese_invasion_target
                }
            }
            if = {
                limit = {
                    has_offmap_tmp_flag = WP_is_not_on_map
                }
                random_independent_ruler = {
                    limit = {
                        capital_scope = {
                            region = custom_eastern_edge_of_map
                        }
                        is_nomadic = no
                        num_of_count_titles_in_realm = 20
                        valid_offmap_china_target = yes
                    }
                    save_event_target_as = chinese_invasion_target
                }
            }
            set_offmap_tmp_flag = start_submission_war
        }
        100 = {
            trigger = {
                has_offmap_tmp_flag = WP_is_on_map
                any_neighbor_independent_ruler = {
                    valid_offmap_china_target_location = yes
                    valid_offmap_china_target = yes
                    is_nomadic = no
                }
            }
            random_neighbor_independent_ruler = {
                limit = {
                    valid_offmap_china_target_location = yes
                    is_nomadic = no
                    valid_offmap_china_target = yes
                }
                save_event_target_as = chinese_invasion_target
            }
            random_neighbor_independent_ruler = {
                limit = {
                    valid_offmap_china_target_location = yes
                    NOT = {
                        num_of_count_titles_in_realm = 20
                    }
                    is_nomadic = no
                    valid_offmap_china_target = yes
                }
                save_event_target_as = chinese_invasion_target
            }
            random_neighbor_independent_ruler = {
                limit = {
                    valid_offmap_china_target_location = yes
                    NOT = {
                        num_of_count_titles_in_realm = 10
                    }
                    is_nomadic = no
                    valid_offmap_china_target = yes
                }
                save_event_target_as = chinese_invasion_target
            }
            random_neighbor_independent_ruler = {
                limit = {
                    valid_offmap_china_target_location = yes
                    NOT = {
                        num_of_count_titles_in_realm = 5
                    }
                    is_nomadic = no
                    valid_offmap_china_target = yes
                }
                save_event_target_as = chinese_invasion_target
            }
            set_offmap_tmp_flag = start_submission_war
            if = {
                limit = {
                    event_target:chinese_invasion_target = {
                        NOT = {
                            num_of_count_titles_in_realm = 20
                        }
                    }
                }
                set_offmap_tmp_flag = attacked_small_neighbor
            }
            else_if = {
                limit = {
                    NOT = {
                        has_policy = china_expansionist
                    }
                }
                log = "-------------------------------------"
                log = "China Logging:"
                log = "Non-expansionist China didn't find a suitable submission target"
                log = "No invasions happened this year - clearing all flags. Better luck next year!"
                log = "Current status = {From.Offmap.GetStatus}. Current policy = {From.Offmap.GetPolicy}."
                log = "-------------------------------------"
                offmap_china = {
                    clr_offmap_tmp_flag = WP_is_on_map
                    clr_offmap_tmp_flag = WP_is_not_on_map
                    clr_offmap_tmp_flag = launching_invasion_of_the_west
                    clr_offmap_tmp_flag = tributary_invasion_fired
                    clr_offmap_tmp_flag = major_invasion_fired
                    clr_offmap_tmp_flag = sent_major_invasion_cleanup
                    clr_offmap_tmp_flag = pretender_chinese_empire_exists
                    clr_offmap_tmp_flag = start_submission_war
                }
                break = yes
            }
            else = {}
        }
    }
    character_event = {
        id = JD.10103
    }
}
100 = {
    modifier = {
        factor = 0
        offmap_china = {
            has_policy = china_expansionist
        }
    }
    log = "-------------------------------------"
    log = "China Logging:"
    log = "No invasions happened this year - clearing all flags. Better luck next year!"
    log = "Current status = {From.Offmap.GetStatus}. Current policy = {From.Offmap.GetPolicy}."
    log = "-------------------------------------"
    offmap_china = {
        clr_offmap_tmp_flag = WP_is_on_map
        clr_offmap_tmp_flag = WP_is_not_on_map
        clr_offmap_tmp_flag = launching_invasion_of_the_west
        clr_offmap_tmp_flag = tributary_invasion_fired
        clr_offmap_tmp_flag = major_invasion_fired
        clr_offmap_tmp_flag = sent_major_invasion_cleanup
        clr_offmap_tmp_flag = pretender_chinese_empire_exists
    }
}
character_event = {
    id = JD.10130
    is_triggered_only = yes
    picture = GFX_evt_china_invades
    desc = EVTDESC_JD_10130_A
    has_dlc = "Jade Dragon"
    immediate = {
        set_character_flag = asked_to_become_tributary
    }
    option = {
        name = {
            text = EVTOPTA_JD_10130
            trigger = {
                NOT = {
                    has_character_modifier = china_raid_active
                }
            }
        }
        name = {
            text = EVTOPTA_JD_10130_B
            trigger = {
                has_character_modifier = china_raid_active
            }
        }
        prestige = -100
        add_grace_minor_effect = yes
        if = {
            limit = {
                is_tributary = yes
            }
            custom_tooltip = {
                text = "REMOVE_PREVIOUS_SUZERAIN"
                hidden_tooltip = {
                    any_suzerain = {
                        ROOT = {
                            remove_tributary = PREV
                        }
                    }
                }
            }
        }
        if = {
            limit = {
                has_character_modifier = china_raid_active
            }
            remove_character_modifier = china_raid_active
            hidden_effect = {
                add_character_modifier = {
                    name = china_raid_grace_cd
                    hidden = yes
                    years = 5
                }
            }
        }
        FROM = {
            prestige = 200
            make_tributary = {
                who = ROOT
                tributary_type = offmap
            }
        }
        any_player = {
            limit = {
                has_offmap_news_enabled = offmap_china
                is_within_diplo_range = ROOT
                NOT = {
                    character = ROOT
                }
            }
            narrative_event = {
                id = JD.10105
            }
        }
        clr_character_flag = asked_to_become_tributary
        ai_chance = {
            factor = 20
            modifier = {
                factor = 1.5
                trait = craven
            }
            modifier = {
                factor = 1.1
                offmap_china = {
                    has_policy = china_expansionist
                }
            }
        }
    }
    option = {
        name = EVTOPTB_JD_10130
        detract_grace_super_huge_effect = yes
        custom_tooltip = {
            text = EVTOPTB_JD_10130_TT
        }
        FROM = {
            character_event = {
                id = JD.10101
            }
        }
        clr_character_flag = asked_to_become_tributary
        ai_chance = {
            factor = 10
            modifier = {
                factor = 1.1
                trait = brave
            }
            modifier = {
                factor = 1.1
                trait = ambitious
            }
            modifier = {
                factor = 1.1
                trait = greedy
            }
            modifier = {
                factor = 1.5
                num_of_count_titles_in_realm = 10
            }
            modifier = {
                factor = 1.5
                num_of_count_titles_in_realm = 15
            }
            modifier = {
                factor = 1.5
                num_of_count_titles_in_realm = 20
            }
        }
    }
}
character_event = {
    id = JD.10101
    desc = EVTDESC_JD_10101
    has_dlc = "Jade Dragon"
    picture = GFX_evt_china_invades
    border = GFX_event_normal_frame_war
    is_triggered_only = yes
    hide_window = yes
    immediate = {
        set_offmap_tmp_flag = tributary_invasion_fired
        if = {
            limit = {
                has_offmap_tmp_flag = WP_is_on_map
            }
            random_realm_province = {
                limit = {
                    is_capital = yes
                }
                save_event_target_as = chinese_invasion_spawn_point_province
            }
        }
        if = {
            limit = {
                has_offmap_tmp_flag = WP_is_not_on_map
            }
            random_list = {
                10 = {
                    1408 = {
                        save_event_target_as = chinese_invasion_spawn_point_province
                    }
                }
                10 = {
                    1448 = {
                        save_event_target_as = chinese_invasion_spawn_point_province
                    }
                }
            }
        }
        war = {
            casus_belli = tributary_offmap_cb
            target = event_target:chinese_invasion_target
        }
        if = {
            limit = {
                event_target:chinese_invasion_target = {
                    NOT = {
                        num_of_count_titles_in_realm = 20
                    }
                }
            }
            log = "-------------------------------------"
            log = "China Logging:"
            log = "China declared MINOR tributary war on {chinese_invasion_target.GetBestName}"
            log = "Current status = {FromFrom.Offmap.GetStatus}. Current policy = {FromFrom.Offmap.GetPolicy}."
            log = "-------------------------------------"
        }
        else = {
            log = "-------------------------------------"
            log = "China Logging:"
            log = "China declared MEDIUM tributary war on {chinese_invasion_target.GetBestName}"
            log = "Current status = {FromFrom.Offmap.GetStatus}. Current policy = {FromFrom.Offmap.GetPolicy}."
            log = "-------------------------------------"
        }
        any_player = {
            limit = {
                has_offmap_news_enabled = offmap_china
                is_within_diplo_range = ROOT
            }
            narrative_event = {
                id = JD.10102
            }
        }
    }
}
narrative_event = {
    id = JD.10105
    has_dlc = "Jade Dragon"
    title = NEWS_FROM_CHINA
    picture = GFX_evt_china_invades
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    is_triggered_only = yes
    desc = {
        text = EVTDESC_JD_10105_A
        trigger = {
            event_target:chinese_invasion_target = {
                NOT = {
                    num_of_count_titles_in_realm = 20
                }
            }
        }
    }
    desc = {
        text = EVTDESC_JD_10105_B
        trigger = {
            event_target:chinese_invasion_target = {
                num_of_count_titles_in_realm = 20
            }
        }
    }
    option = {
        name = EVTOPTA_JD_10105
        show_portrait = event_target:chinese_invasion_target
        custom_tooltip = {
            text = EVTOPTA_JD_10105_TT
        }
    }
}
narrative_event = {
    id = JD.10102
    has_dlc = "Jade Dragon"
    title = NEWS_FROM_CHINA
    picture = GFX_evt_china_invades
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    desc = {
        text = EVTDESC_JD_10102_A
        trigger = {
            event_target:chinese_invasion_target = {
                character = ROOT
            }
        }
    }
    desc = {
        text = EVTDESC_JD_10102_B
        trigger = {
            NOT = {
                event_target:chinese_invasion_target = {
                    character = ROOT
                }
            }
        }
    }
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    option = {
        name = {
            text = EVTOPTA_JD_10102_A_brave
            trigger = {
                trait = brave
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_craven
            trigger = {
                trait = craven
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_pious
            trigger = {
                is_pious_trigger = yes
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_neutral
            trigger = {
                NOT = {
                    trait = craven
                }
                NOT = {
                    trait = brave
                }
                NOT = {
                    is_pious_trigger = yes
                }
            }
        }
        trigger = {
            event_target:chinese_invasion_target = {
                character = ROOT
            }
        }
    }
    option = {
        name = {
            text = EVTOPTA_JD_10102_B_same_religion
            trigger = {
                event_target:chinese_invasion_target = {
                    religion_group = ROOT
                }
            }
        }
        name = {
            text = EVTOPTA_JD_10102_B_other_religion
            trigger = {
                NOT = {
                    event_target:chinese_invasion_target = {
                        religion_group = ROOT
                    }
                }
            }
        }
        event_target:chinese_invasion_target = {
            show_portrait = yes
        }
        trigger = {
            NOT = {
                event_target:chinese_invasion_target = {
                    character = ROOT
                }
            }
        }
    }
}
character_event = {
    id = JD.10103
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    immediate = {
        if = {
            limit = {
                NOT = {
                    has_offmap_tmp_flag = attacked_small_neighbor
                }
            }
            set_offmap_tmp_flag = major_invasion_fired
        }
        if = {
            limit = {
                has_offmap_tmp_flag = WP_is_on_map
            }
            random_realm_province = {
                limit = {
                    is_capital = yes
                }
                save_event_target_as = chinese_invasion_spawn_point_province
            }
        }
        if = {
            limit = {
                has_offmap_tmp_flag = WP_is_not_on_map
            }
            random_list = {
                10 = {
                    1408 = {
                        save_event_target_as = chinese_invasion_spawn_point_province
                    }
                }
                10 = {
                    1448 = {
                        save_event_target_as = chinese_invasion_spawn_point_province
                    }
                }
                10 = {
                    1513 = {
                        save_event_target_as = chinese_invasion_spawn_point_province
                    }
                }
                10 = {
                    1450 = {
                        save_event_target_as = chinese_invasion_spawn_point_province
                    }
                }
                10 = {
                    1446 = {
                        save_event_target_as = chinese_invasion_spawn_point_province
                    }
                }
                10 = {
                    1449 = {
                        save_event_target_as = chinese_invasion_spawn_point_province
                    }
                }
            }
        }
        if = {
            limit = {
                has_offmap_tmp_flag = should_claim_all_titles_war
            }
            if = {
                limit = {
                    can_use_cb = {
                        casus_belli = claim_all
                        target = event_target:chinese_invasion_target
                        only_check_triggers = yes
                    }
                }
                war = {
                    casus_belli = claim_all
                    target = event_target:chinese_invasion_target
                }
            }
            else = {
                any_claim = {
                    limit = {
                        holder_scope = {
                            OR = {
                                character = event_target:chinese_invasion_target
                                top_liege = {
                                    character = event_target:chinese_invasion_target
                                }
                            }
                        }
                    }
                    ROOT = {
                        war = {
                            casus_belli = claim
                            target = event_target:chinese_invasion_target
                            thirdparty_title = PREV
                        }
                    }
                }
            }
        }
        if = {
            limit = {
                has_offmap_tmp_flag = start_submission_war
            }
            war = {
                casus_belli = offmap_submission
                target = event_target:chinese_invasion_target
            }
        }
        log = "-------------------------------------"
        log = "China Logging:"
        log = "China declared submission/claim war on {chinese_invasion_target.GetBestName}"
        log = "Current status = {From.Offmap.GetStatus}. Current policy = {From.Offmap.GetPolicy}."
        log = "-------------------------------------"
        if = {
            limit = {
                has_offmap_tmp_flag = start_submission_war
            }
            if = {
                limit = {
                    event_target:chinese_invasion_target = {
                        NOT = {
                            num_of_count_titles_in_realm = 20
                        }
                    }
                }
                log = "-------------------------------------"
                log = "China War Logging:"
                log = "China declared MINOR submission war on {chinese_invasion_target.GetBestName}"
                log = "Current status = {FromFrom.Offmap.GetStatus}. Current policy = {FromFrom.Offmap.GetPolicy}."
                log = "-------------------------------------"
            }
            else = {
                log = "-------------------------------------"
                log = "China War Logging:"
                log = "China declared MAJOR submission war on {chinese_invasion_target.GetBestName}"
                log = "Current status = {FromFrom.Offmap.GetStatus}. Current policy = {FromFrom.Offmap.GetPolicy}."
                log = "-------------------------------------"
            }
        }
        if = {
            limit = {
                has_offmap_tmp_flag = should_claim_all_titles_war
            }
            if = {
                limit = {
                    event_target:chinese_invasion_target = {
                        NOT = {
                            num_of_count_titles_in_realm = 20
                        }
                    }
                }
                log = "-------------------------------------"
                log = "China War Logging:"
                log = "China declared MINOR claim war on {chinese_invasion_target.GetBestName}"
                log = "Current status = {FromFrom.Offmap.GetStatus}. Current policy = {FromFrom.Offmap.GetPolicy}."
                log = "-------------------------------------"
            }
            else = {
                log = "-------------------------------------"
                log = "China War Logging:"
                log = "China declared MEDIUM claim war on {chinese_invasion_target.GetBestName}"
                log = "Current status = {FromFrom.Offmap.GetStatus}. Current policy = {FromFrom.Offmap.GetPolicy}."
                log = "-------------------------------------"
            }
        }
        clr_offmap_tmp_flag = start_submission_war
        clr_offmap_tmp_flag = should_claim_all_titles_war
        any_player = {
            limit = {
                has_offmap_news_enabled = offmap_china
                is_within_diplo_range = ROOT
            }
            narrative_event = {
                id = JD.10104
                days = 1
            }
        }
    }
}
narrative_event = {
    id = JD.10104
    title = NEWS_FROM_CHINA
    picture = GFX_evt_china_invades
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    has_dlc = "Jade Dragon"
    desc = {
        text = EVTDESC_JD_10104_A
        trigger = {
            event_target:chinese_invasion_target = {
                character = ROOT
            }
        }
    }
    desc = {
        text = EVTDESC_JD_10104_B
        trigger = {
            NOT = {
                event_target:chinese_invasion_target = {
                    character = ROOT
                }
            }
        }
    }
    is_triggered_only = yes
    option = {
        name = {
            text = EVTOPTA_JD_10102_A_brave
            trigger = {
                trait = brave
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_craven
            trigger = {
                trait = craven
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_pious
            trigger = {
                is_pious_trigger = yes
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_neutral
            trigger = {
                NOT = {
                    trait = craven
                }
                NOT = {
                    trait = brave
                }
                NOT = {
                    is_pious_trigger = yes
                }
            }
        }
        trigger = {
            event_target:chinese_invasion_target = {
                character = ROOT
            }
        }
    }
    option = {
        name = {
            text = EVTOPTA_JD_10104_B_brave
            trigger = {
                trait = brave
            }
        }
        name = {
            text = EVTOPTA_JD_10104_B_pious
            trigger = {
                is_pious_trigger = yes
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_neutral
            trigger = {
                NOT = {
                    trait = craven
                }
                NOT = {
                    is_pious_trigger = yes
                }
            }
        }
        event_target:chinese_invasion_target = {
            show_portrait = yes
        }
        trigger = {
            NOT = {
                event_target:chinese_invasion_target = {
                    character = ROOT
                }
            }
        }
    }
}
character_event = {
    id = JD.10200
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    trigger = {
        FROM = {
            is_offmap_tag = offmap_china
        }
        OR = {
            offmap_china = {
                had_offmap_tmp_flag = {
                    flag = tributary_invasion_fired
                    years = 5
                }
            }
            offmap_china = {
                had_offmap_tmp_flag = {
                    flag = launching_invasion_of_the_west
                    years = 5
                }
            }
            offmap_china = {
                had_offmap_tmp_flag = {
                    flag = attacked_small_neighbor
                    years = 3
                }
            }
        }
    }
    immediate = {
        offmap_china = {
            clr_offmap_tmp_flag = WP_is_on_map
            clr_offmap_tmp_flag = WP_is_not_on_map
            clr_offmap_tmp_flag = launching_invasion_of_the_west
            clr_offmap_tmp_flag = tributary_invasion_fired
            clr_offmap_tmp_flag = attacked_small_neighbor
        }
    }
}
character_event = {
    id = JD.10201
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    trigger = {
        FROM = {
            is_offmap_tag = offmap_china
        }
        offmap_china = {
            OR = {
                had_offmap_tmp_flag = {
                    flag = major_invasion_fired
                    years = 20
                }
                had_offmap_tmp_flag = {
                    flag = sent_major_invasion_cleanup
                    years = 5
                }
            }
        }
    }
    immediate = {
        offmap_china = {
            clr_offmap_tmp_flag = major_invasion_fired
            clr_offmap_tmp_flag = sent_major_invasion_cleanup
        }
    }
}
character_event = {
    id = JD.10202
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    trigger = {
        is_offmap_tag = offmap_china
        offmap_china = {
            NOT = {
                has_policy = china_isolationist
            }
            OR = {
                has_offmap_tmp_flag = WP_is_on_map
                has_offmap_tmp_flag = WP_is_not_on_map
                has_offmap_tmp_flag = major_invasion_fired
                has_offmap_tmp_flag = launching_invasion_of_the_west
                has_offmap_tmp_flag = tributary_invasion_fired
                has_offmap_tmp_flag = major_invasion_fired
                has_offmap_tmp_flag = attacked_small_neighbor
            }
        }
    }
    immediate = {
        set_offmap_tmp_flag = sent_major_invasion_cleanup
    }
}
character_event = {
    id = JD.10121
    has_dlc = "Jade Dragon"
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        FROM = {
            is_offmap_tag = offmap_china
            OR = {
                has_offmap_flag = waiting_to_spawn_a_displaced_royal
                has_offmap_flag = waiting_to_spawn_a_jurchen_invader
                has_offmap_flag = waiting_to_spawn_a_rebel_general
            }
        }
    }
    immediate = {
        FROM = {
            trigger_switch = {
                on_trigger = has_offmap_flag
                waiting_to_spawn_a_displaced_royal = {
                    governor = {
                        character_event = {
                            id = JD.10113
                            days = 15
                        }
                    }
                    log = "China Logging:"
                    log = "Attempting to spawn a Displaced Royal, via monthly pulse fallback event (since the old governor left office). Character should spawn in 15 days."
                }
                waiting_to_spawn_a_jurchen_invader = {
                    governor = {
                        character_event = {
                            id = JD.10109
                            days = 15
                        }
                    }
                    log = "China Logging:"
                    log = "Attempting to spawn a Jurchen Invader, via monthly pulse fallback event (since the old governor left office). Character should spawn in 15 days."
                }
                waiting_to_spawn_a_rebel_general = {
                    governor = {
                        character_event = {
                            id = JD.60200
                            days = 15
                        }
                    }
                    log = "China Logging:"
                    log = "Attempting to spawn a Rebel General, via monthly pulse fallback event (since the old governor left office). Character should spawn in 15 days."
                }
            }
            clr_offmap_flag = waiting_to_spawn_a_displaced_royal
            clr_offmap_flag = waiting_to_spawn_a_jurchen_invader
            clr_offmap_flag = waiting_to_spawn_a_rebel_general
        }
    }
}
narrative_event = {
    id = JD.10108
    has_dlc = "Jade Dragon"
    title = NEWS_FROM_CHINA
    picture = GFX_evt_china_rebel_general
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    is_triggered_only = yes
    desc = {
        text = EVTDESC_JD_10108_JURCHEN
        trigger = {
            event_target:the_chinese_invader = {
                has_character_flag = is_jurchen_invader
            }
        }
    }
    desc = {
        text = EVTDESC_JD_10108_DISPLACED_PRINCE
        trigger = {
            event_target:the_chinese_invader = {
                has_character_flag = is_displaced_prince
            }
        }
    }
    desc = {
        text = EVTDESC_JD_10108_REBEL_GENERAL
        trigger = {
            event_target:the_chinese_invader = {
                has_character_flag = is_rebel_general
            }
        }
    }
    has_dlc = "Jade Dragon"
    trigger = {
        event_target:the_chinese_invader = {
            is_alive = yes
        }
    }
    option = {
        name = EVTOPTA_JD_10108
    }
}
character_event = {
    id = JD.10109
    has_dlc = "Jade Dragon"
    hide_window = yes
    is_triggered_only = yes
    trigger = {}
    immediate = {
        clr_character_flag = spawning_a_displaced_royal
        clr_character_flag = spawning_a_jurchen_invader
        clr_character_flag = spawning_a_rebel_general
        save_event_target_as = the_protector_general
        random_list = {
            50 = {
                create_character = {
                    random_traits = yes
                    religion = taoist
                    culture = jurchen
                    dynasty = actually_culture
                    female = no
                    age = 30
                    trait = tough_soldier
                    historical = yes
                }
                new_character = {
                    add_trait = ambitious
                    remove_trait = content
                    remove_trait = craven
                    set_character_flag = is_jurchen_invader
                    save_event_target_as = jurchen_invader
                    save_event_target_as = the_chinese_invader
                    character_event = {
                        id = JD.10110
                    }
                    log = "China Logging:"
                    log = "{This.GetFullName} ID {This.GetID} is the Jurchen Invader"
                }
            }
            50 = {
                create_character = {
                    random_traits = yes
                    religion = taoist
                    culture = khitan
                    dynasty = actually_culture
                    female = no
                    age = 30
                    trait = tough_soldier
                    historical = yes
                }
                new_character = {
                    add_trait = ambitious
                    remove_trait = content
                    remove_trait = craven
                    set_character_flag = is_jurchen_invader
                    save_event_target_as = jurchen_invader
                    save_event_target_as = the_chinese_invader
                    character_event = {
                        id = JD.10110
                    }
                    log = "China Logging:"
                    log = "{This.GetFullName} ID {This.GetID} is the Jurchen Invader"
                }
            }
        }
        any_player = {
            limit = {
                has_offmap_news_enabled = offmap_china
                is_within_diplo_range = ROOT
            }
            narrative_event = {
                id = JD.10108
                days = 1
            }
        }
    }
}
character_event = {
    id = JD.10113
    has_dlc = "Jade Dragon"
    hide_window = yes
    is_triggered_only = yes
    trigger = {}
    immediate = {
        clr_character_flag = spawning_a_displaced_royal
        clr_character_flag = spawning_a_jurchen_invader
        clr_character_flag = spawning_a_rebel_general
        save_event_target_as = the_protector_general
        offmap_china = {
            offmap_prev_ruler = {
                save_event_target_as = previousEmperor
            }
        }
        create_character = {
            random_traits = yes
            religion = taoist
            culture = event_target:previousEmperor
            dynasty = event_target:previousEmperor
            female = no
            age = 20
            trait = tough_soldier
            historical = yes
        }
        new_character = {
            save_event_target_as = displaced_prince
            if = {
                limit = {
                    event_target:previousEmperor = {
                        could_be_parent_of = event_target:displaced_prince
                    }
                }
                set_father = event_target:previousEmperor
            }
            else_if = {
                limit = {
                    event_target:previousEmperor = {
                        father_even_if_dead = {
                            could_be_parent_of = event_target:displaced_prince
                        }
                    }
                }
                event_target:previousEmperor = {
                    father_even_if_dead = {
                        event_target:displaced_prince = {
                            set_father = PREV
                        }
                    }
                }
            }
            else_if = {
                limit = {
                    event_target:previousEmperor = {
                        any_dynasty_member_even_if_dead = {
                            is_or_was_offmap_power_ruler = yes
                            is_female = no
                            could_be_parent_of = event_target:displaced_prince
                        }
                    }
                }
                event_target:previousEmperor = {
                    random_dynasty_member_even_if_dead = {
                        limit = {
                            is_or_was_offmap_power_ruler = yes
                            is_female = no
                            could_be_parent_of = event_target:displaced_prince
                        }
                        event_target:displaced_prince = {
                            set_father = PREV
                        }
                    }
                }
            }
            else_if = {
                limit = {
                    event_target:previousEmperor = {
                        any_dynasty_member_even_if_dead = {
                            is_or_was_offmap_power_ruler = yes
                            is_female = yes
                            could_be_parent_of = event_target:displaced_prince
                        }
                    }
                }
                event_target:previousEmperor = {
                    random_dynasty_member_even_if_dead = {
                        limit = {
                            is_or_was_offmap_power_ruler = yes
                            is_female = yes
                            could_be_parent_of = event_target:displaced_prince
                        }
                        event_target:displaced_prince = {
                            set_mother = PREV
                        }
                    }
                }
            }
            else_if = {
                limit = {
                    event_target:previousEmperor = {
                        any_dynasty_member_even_if_dead = {
                            is_female = no
                            could_be_parent_of = event_target:displaced_prince
                        }
                    }
                }
                event_target:previousEmperor = {
                    random_dynasty_member_even_if_dead = {
                        limit = {
                            is_female = no
                            could_be_parent_of = event_target:displaced_prince
                        }
                        event_target:displaced_prince = {
                            set_father = PREV
                        }
                    }
                }
            }
            add_trait = ambitious
            remove_trait = content
            remove_trait = craven
            set_character_flag = is_displaced_prince
            add_character_modifier = {
                name = jd_prince
                duration = -1
            }
            save_event_target_as = the_chinese_invader
            wealth = 1000
            character_event = {
                id = JD.10110
            }
            log = "China Logging:"
            log = "{This.GetFullName} ID {This.GetID} is the Displaced Prince"
        }
        any_player = {
            limit = {
                has_offmap_news_enabled = offmap_china
                is_within_diplo_range = ROOT
            }
            narrative_event = {
                id = JD.10108
                days = 1
            }
        }
    }
}
character_event = {
    id = JD.10110
    hide_window = yes
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    capable_only = yes
    prisoner = no
    trigger = {
        NOT = {
            has_game_rule = {
                name = adventurers
                value = none
            }
        }
    }
    immediate = {
        add_trait = adventurer
        set_defacto_liege = ROOT
        create_title = {
            tier = DUKE
            landless = yes
            adventurer = yes
            culture = ROOT
            name = "CLAIMANT_ADVENTURE"
            holder = ROOT
            base_title = THIS
        }
        if = {
            limit = {
                has_character_flag = is_jurchen_invader
            }
            set_character_flag = raiding_adventurer_nomad
        }
        set_character_flag = raiding_adventurer
        change_variable = {
            which = global_raiding_adventurer_spawn_by_jurchen_invasion
            value = 1
        }
        if = {
            limit = {
                has_character_flag = is_jurchen_invader
            }
            1457 = {
                save_event_target_as = target_province
            }
        }
        if = {
            limit = {
                has_character_flag = is_displaced_prince
            }
            1513 = {
                save_event_target_as = target_province
            }
        }
        if = {
            limit = {
                has_character_flag = is_displaced_prince
            }
            random_list = {
                30 = {
                    spawn_unit = {
                        province = event_target:target_province
                        home = event_target:target_province
                        owner = ROOT
                        attrition = 0
                        reinforces = yes
                        is_looter = yes
                        can_toggle_looting = no
                        cannot_inherit = yes
                        merge = yes
                        troops = {
                            archers = {
                                500
                                500
                            }
                            light_infantry = {
                                1200
                                1200
                            }
                            heavy_infantry = {
                                300
                                300
                            }
                        }
                    }
                }
                30 = {
                    spawn_unit = {
                        province = event_target:target_province
                        home = event_target:target_province
                        owner = ROOT
                        attrition = 0
                        reinforces = yes
                        is_looter = yes
                        can_toggle_looting = no
                        cannot_inherit = yes
                        merge = yes
                        troops = {
                            archers = {
                                750
                                750
                            }
                            light_infantry = {
                                1800
                                1800
                            }
                            heavy_infantry = {
                                450
                                450
                            }
                        }
                    }
                }
                30 = {
                    spawn_unit = {
                        province = event_target:target_province
                        home = event_target:target_province
                        owner = ROOT
                        attrition = 0
                        reinforces = yes
                        is_looter = yes
                        can_toggle_looting = no
                        cannot_inherit = yes
                        merge = yes
                        troops = {
                            archers = {
                                1000
                                1000
                            }
                            light_infantry = {
                                2400
                                2400
                            }
                            heavy_infantry = {
                                600
                                600
                            }
                        }
                    }
                }
            }
        }
        if = {
            limit = {
                has_character_flag = is_jurchen_invader
            }
            random_list = {
                30 = {
                    spawn_unit = {
                        province = event_target:target_province
                        home = event_target:target_province
                        owner = ROOT
                        attrition = 0
                        reinforces = yes
                        is_looter = yes
                        can_toggle_looting = no
                        cannot_inherit = yes
                        merge = yes
                        troops = {
                            light_cavalry = {
                                1000
                                1000
                            }
                            horse_archers = {
                                800
                                800
                            }
                        }
                    }
                }
                30 = {
                    spawn_unit = {
                        province = event_target:target_province
                        home = event_target:target_province
                        owner = ROOT
                        attrition = 0
                        reinforces = yes
                        is_looter = yes
                        can_toggle_looting = no
                        cannot_inherit = yes
                        merge = yes
                        troops = {
                            light_cavalry = {
                                1500
                                1500
                            }
                            horse_archers = {
                                1200
                                1200
                            }
                        }
                    }
                }
                30 = {
                    spawn_unit = {
                        province = event_target:target_province
                        home = event_target:target_province
                        owner = ROOT
                        attrition = 0
                        reinforces = yes
                        is_looter = yes
                        can_toggle_looting = no
                        cannot_inherit = yes
                        merge = yes
                        troops = {
                            light_cavalry = {
                                2000
                                2000
                            }
                            horse_archers = {
                                1600
                                1600
                            }
                        }
                    }
                }
            }
        }
        create_random_soldier = {
            random_traits = yes
            dynasty = none
            religion = ROOT
            culture = ROOT
            female = no
            age = 30
        }
        create_random_soldier = {
            random_traits = yes
            dynasty = none
            religion = ROOT
            culture = ROOT
            female = no
            age = 25
        }
        character_event = {
            id = JD.10111
            days = 1095
        }
    }
}
character_event = {
    id = JD.10111
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    has_character_flag = raiding_adventurer
    trigger = {
        primary_title = {
            temporary = yes
        }
    }
    immediate = {
        log = "Event JD.10111 for raiding altaic adventurer = {Root.GetBestName} - approach someone or continue raiding?"
        if = {
            limit = {
                OR = {
                    wealth = 300
                    had_character_flag = {
                        flag = raiding_adventurer
                        days = 1825
                    }
                }
                any_independent_ruler = {
                    has_opinion_modifier = {
                        who = ROOT
                        modifier = opinion_looted
                    }
                    NOT = {
                        realm_levy_diff = {
                            who = ROOT
                            value = 3000
                        }
                    }
                    demesne_size = 1
                }
            }
            random_list = {
                50 = {
                    modifier = {
                        trait = cruel
                        factor = 2
                    }
                    modifier = {
                        trait = ambitious
                        factor = 2
                    }
                    log = "{Root.GetBestName} prepares to settle."
                    character_event = {
                        id = JD.10112
                    }
                }
                50 = {
                    modifier = {
                        had_character_flag = {
                            flag = raiding_adventurer
                            days = 2555
                        }
                        factor = 0.5
                    }
                    modifier = {
                        had_character_flag = {
                            flag = raiding_adventurer
                            days = 3285
                        }
                        factor = 0.5
                    }
                    modifier = {
                        had_character_flag = {
                            flag = raiding_adventurer
                            days = 4015
                        }
                        factor = 0.5
                    }
                    modifier = {
                        had_character_flag = {
                            flag = raiding_adventurer
                            days = 10950
                        }
                        factor = 0
                    }
                    log = "{Root.GetBestName} continues raiding."
                    repeat_event = {
                        id = JD.10111
                        days = 365
                    }
                }
            }
        }
        else_if = {
            limit = {
                had_character_flag = {
                    flag = raiding_adventurer
                    days = 10950
                }
            }
            character_event = {
                id = JD.10112
            }
            break = yes
        }
        else = {
            log = "{Root.GetBestName} continues raiding."
            repeat_event = {
                id = JD.10111
                days = 365
            }
        }
    }
}
character_event = {
    id = JD.10112
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    immediate = {
        any_army = {
            set_can_toggle_looting = yes
            set_looting = no
        }
        random_independent_ruler = {
            limit = {
                has_opinion_modifier = {
                    who = ROOT
                    modifier = opinion_looted
                }
                NOT = {
                    realm_levy_diff = {
                        who = ROOT
                        value = 3000
                    }
                }
                demesne_size = 1
                NOT = {
                    has_character_flag = negotiating_with_adventurer
                }
                NOT = {
                    any_realm_province = {
                        has_province_modifier = settled_adventurer
                    }
                }
            }
            save_event_target_as = random_ruler_target
            if = {
                limit = {
                    higher_real_tier_than = DUKE
                }
                set_character_flag = negotiating_with_adventurer
                character_event = {
                    id = ADV.1
                }
                ROOT = {
                    character_event = {
                        id = JD.10120
                        days = 65
                    }
                }
                break = yes
            }
            if = {
                limit = {
                    NOT = {
                        higher_real_tier_than = DUKE
                    }
                }
                clr_character_flag = raiding_adventurer
                random_realm_province = {
                    limit = {
                        any_neighbor_province = {
                            NOT = {
                                owner = {
                                    same_realm = ROOT
                                }
                            }
                        }
                    }
                    ROOT = {
                        unsafe_war = {
                            target = event_target:random_ruler_target
                            casus_belli = duchy_adventure
                            thirdparty_title = PREV
                            tier = DUKE
                        }
                        event_target:random_ruler_target = {
                            character_event = {
                                id = HL.112
                            }
                        }
                    }
                    break = yes
                }
                random_realm_province = {
                    ROOT = {
                        unsafe_war = {
                            target = event_target:random_ruler_target
                            casus_belli = duchy_adventure
                            thirdparty_title = PREV
                            tier = DUKE
                        }
                        event_target:random_ruler_target = {
                            character_event = {
                                id = HL.112
                            }
                        }
                    }
                }
                if = {
                    limit = {
                        war = yes
                    }
                    break = yes
                }
            }
        }
        clr_character_flag = raiding_adventurer
        log = "{SERIOUS} {Root.GetTitledFirstName} failed to find a target after trying to end his raiding adventure."
        character_event = {
            id = HL.199
        }
    }
}
character_event = {
    id = JD.10114
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    immediate = {
        any_army = {
            set_can_toggle_looting = yes
            set_looting = no
        }
        clr_character_flag = raiding_adventurer
        event_target:target_province = {
            owner = {
                character_event = {
                    id = HL.112
                }
                ROOT = {
                    war = {
                        target = PREV
                        casus_belli = duchy_adventure
                        thirdparty_title = PREVPREV
                        tier = DUKE
                    }
                }
            }
        }
    }
}
character_event = {
    id = JD.10115
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    immediate = {
        clr_character_flag = raiding_adventurer
        disband_event_forces = yes
        clan_title = {
            activate_title = {
                title = THIS
                status = no
            }
            destroy_landed_title = THIS
        }
        primary_title = {
            if = {
                limit = {
                    OR = {
                        AND = {
                            tier = DUKE
                            adventurer = yes
                        }
                        tier = EMPEROR
                    }
                }
                activate_title = {
                    title = THIS
                    status = no
                }
                destroy_landed_title = THIS
            }
        }
        if = {
            limit = {
                prisoner = no
            }
            if = {
                limit = {
                    father = {
                        is_alive = yes
                    }
                }
                father = {
                    if = {
                        limit = {
                            is_ruler = yes
                        }
                        ROOT = {
                            set_defacto_liege = PREV
                            break = yes
                        }
                    }
                    if = {
                        limit = {
                            is_ruler = no
                        }
                        liege = {
                            ROOT = {
                                set_defacto_liege = PREV
                                break = yes
                            }
                        }
                    }
                }
            }
        }
    }
}
character_event = {
    id = JD.10120
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    hide_window = yes
    trigger = {
        war = no
        primary_title = {
            temporary = yes
            adventurer = yes
        }
    }
    immediate = {
        character_event = {
            id = JD.10111
        }
    }
}
province_event = {
    id = JD.60100
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        FROM = {
            change_variable = {
                which = "WP_nomad_provinces"
                value = 1
            }
        }
    }
}
character_event = {
    id = JD.60101
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        log = "-------------------------------------"
        log = "China Logging:"
        log = "The Western Protectorate has gained {Root.WP_nomad_provinces.GetValue} nomad provinces from the war."
        log = "The amount of gold that shall recieved is 200 per nomad province modified by the current status of China"
        set_variable = {
            which = "WP_nomad_gold_from_china"
            which = "WP_nomad_provinces"
        }
        multiply_variable = {
            which = "WP_nomad_gold_from_china"
            value = 200
        }
        if = {
            limit = {
                china_is_suffering_trigger = yes
            }
            multiply_variable = {
                which = "WP_nomad_gold_from_china"
                value = 0.3
            }
            log = "As China is currently not doing well, the amount of gold sent will be 0.3 times the normal."
        }
        if = {
            limit = {
                china_is_fine_trigger = yes
            }
            multiply_variable = {
                which = "WP_nomad_gold_from_china"
                value = 1.5
            }
            log = "As China is currently doing well, the amount of gold sent will be 1.5 times the normal."
        }
        if = {
            limit = {
                check_variable = {
                    which = "WP_nomad_gold_from_china"
                    value = 2500
                }
            }
            log = "The amount of gold being sent is {Root.WP_nomad_gold_from_china.GetValue}, the cap of what can be sent is 2500 so the amount has been set to 2500"
            set_variable = {
                which = "WP_nomad_gold_from_china"
                which = 2500
            }
        }
        log = "China has sent {Root.WP_nomad_gold_from_china.GetValue} gold to aid with building holdings."
        wealth = WP_nomad_gold_from_china
        log = "-------------------------------------"
    }
}
character_event = {
    id = JD.60200
    hide_window = yes
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    immediate = {
        clr_character_flag = spawning_a_displaced_royal
        clr_character_flag = spawning_a_jurchen_invader
        clr_character_flag = spawning_a_rebel_general
        save_event_target_as = the_protector_general
        random_list = {
            1 = {
                create_character = {
                    age = 27
                    random_traits = yes
                    female = no
                    religion = taoist
                    culture = han
                    dynasty = actually_culture
                    trait = brilliant_strategist
                    martial = 8
                    flag = young_general
                    historical = yes
                }
            }
            2 = {
                create_character = {
                    age = 36
                    random_traits = yes
                    female = no
                    religion = taoist
                    culture = han
                    dynasty = actually_culture
                    trait = brilliant_strategist
                    martial = 10
                    flag = middle_general
                    historical = yes
                }
            }
            1 = {
                create_character = {
                    age = 52
                    random_traits = yes
                    female = no
                    religion = taoist
                    culture = han
                    dynasty = actually_culture
                    trait = brilliant_strategist
                    martial = 12
                    flag = old_general
                    historical = yes
                }
            }
        }
        new_character = {
            change_martial = 7
            add_trait = ambitious
            add_trait = brave
            random_list = {
                30 = {
                    trigger = {
                        can_have_more_leadership_traits = yes
                        NOT = {
                            trait = master_of_flame
                        }
                    }
                    add_trait = master_of_flame
                }
                30 = {
                    trigger = {
                        can_have_more_leadership_traits = yes
                        NOT = {
                            trait = logistics_expert
                        }
                    }
                    add_trait = logistics_expert
                }
                30 = {
                    trigger = {
                        can_have_more_leadership_traits = yes
                        NOT = {
                            trait = levy_coordinator
                        }
                    }
                    add_trait = levy_coordinator
                }
                30 = {
                    trigger = {
                        can_have_more_leadership_traits = yes
                        NOT = {
                            trait = sapper
                        }
                    }
                    add_trait = sapper
                }
            }
            set_character_flag = is_rebel_general
            save_event_target_as = rebel_general
            save_event_target_as = the_chinese_invader
            wealth = 200
            log = "China Logging:"
            log = "{This.GetFullName} ID {This.GetID} is the Rebel General"
            character_event = {
                id = JD.60201
            }
        }
        any_player = {
            limit = {
                has_offmap_news_enabled = offmap_china
                is_within_diplo_range = ROOT
            }
            narrative_event = {
                id = JD.10108
                days = 1
            }
        }
    }
}
character_event = {
    id = JD.60201
    hide_window = yes
    has_dlc = "Jade Dragon"
    is_triggered_only = yes
    capable_only = yes
    prisoner = no
    trigger = {
        NOT = {
            has_game_rule = {
                name = adventurers
                value = none
            }
        }
    }
    immediate = {
        log = "China Logging:"
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target_location = yes
                in_revolt = no
                is_within_diplo_range = event_target:the_protector_general
                is_landed = yes
                is_nomadic = no
                higher_tier_than = BARON
            }
            save_event_target_as = rebel_general_target
            log = "{rebel_general_target.GetFullName} ID {rebel_general_target.GetID} is the Rebel General's Worst Case Target."
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target_location = yes
                NOT = {
                    event_target:the_protector_general = {
                        character = PREV
                    }
                }
                in_revolt = no
                is_within_diplo_range = event_target:the_protector_general
                is_landed = yes
                is_nomadic = no
                higher_tier_than = BARON
            }
            save_event_target_as = rebel_general_target
            log = "{rebel_general_target.GetFullName} ID {rebel_general_target.GetID} is the Rebel General's Non China Worst Case Target."
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target_location = yes
                NOT = {
                    event_target:the_protector_general = {
                        character = PREV
                    }
                }
                in_revolt = no
                is_within_diplo_range = event_target:the_protector_general
                is_landed = yes
                is_nomadic = no
                higher_tier_than = COUNT
                num_of_count_titles_in_realm = 5
            }
            save_event_target_as = rebel_general_target
            log = "{rebel_general_target.GetFullName} ID {rebel_general_target.GetID} is the Rebel General's Duke Target."
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target_location = yes
                NOT = {
                    event_target:the_protector_general = {
                        character = PREV
                    }
                }
                in_revolt = no
                is_within_diplo_range = event_target:the_protector_general
                is_landed = yes
                is_nomadic = no
                higher_tier_than = DUKE
                num_of_count_titles_in_realm = 15
            }
            save_event_target_as = rebel_general_target
            log = "{rebel_general_target.GetFullName} ID {rebel_general_target.GetID} is the Rebel General's King Target."
        }
        random_independent_ruler = {
            limit = {
                valid_offmap_china_target_location = yes
                NOT = {
                    event_target:the_protector_general = {
                        character = PREV
                    }
                }
                in_revolt = no
                is_within_diplo_range = event_target:the_protector_general
                is_landed = yes
                is_nomadic = no
                higher_tier_than = KING
                num_of_count_titles_in_realm = 30
            }
            save_event_target_as = rebel_general_target
            log = "{rebel_general_target.GetFullName} ID {rebel_general_target.GetID} is the Rebel General's Emperor Target."
        }
        if = {
            limit = {
                NOT = {
                    event_target:rebel_general_target = {
                        always = yes
                    }
                }
            }
            death = {
                death_reason = death_went_back_to_china
            }
            log = "{This.GetFullName} ID {This.GetID} is the Rebel General and could not find a target therefore he is getting removed."
            break = yes
        }
        log = "{rebel_general_target.GetFullName} ID {rebel_general_target.GetID} is the Rebel General's Final Target."
        create_title = {
            tier = EMPEROR
            temporary = no
            landless = yes
            custom_created = yes
            culture = ROOT
            name = "REBEL_GENERAL"
            holder = ROOT
            base_title = THIS
            short_name = yes
        }
        new_title = {
            save_event_target_as = rebel_general_title
        }
        set_defacto_liege = ROOT
        set_special_character_title = TITLE_GENERAL
        trigger_switch = {
            on_trigger = has_character_flag
            young_general = {
                create_character = {
                    age = 24
                    random_traits = yes
                    female = yes
                    religion = taoist
                    culture = han
                    historical = yes
                }
                new_character = {
                    add_spouse = ROOT
                    create_character = {
                        age = 6
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                    create_character = {
                        age = 6
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                }
            }
            middle_general = {
                create_character = {
                    age = 32
                    random_traits = yes
                    female = yes
                    religion = taoist
                    culture = han
                    historical = yes
                }
                new_character = {
                    add_spouse = ROOT
                    create_character = {
                        age = 7
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                    create_character = {
                        age = 10
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                    create_character = {
                        age = 13
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                }
            }
            old_general = {
                create_character = {
                    age = 48
                    random_traits = yes
                    female = yes
                    religion = taoist
                    culture = han
                    historical = yes
                }
                new_character = {
                    add_spouse = ROOT
                    create_character = {
                        age = 4
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                    create_character = {
                        age = 9
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                    create_character = {
                        age = 14
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                    create_character = {
                        age = 18
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                    create_character = {
                        age = 21
                        random_traits = yes
                        female = 50
                        religion = taoist
                        culture = han
                        genetic_father = ROOT
                        genetic_mother = PREV
                        historical = yes
                    }
                    new_character = {
                        dynasty = ROOT
                        set_father = ROOT
                        set_mother = PREV
                    }
                }
            }
        }
        clr_character_flag = young_general
        clr_character_flag = middle_general
        clr_character_flag = old_general
        prestige = 500
        event_target:rebel_general_target = {
            character_event = {
                id = JD.60202
                days = 5
            }
        }
    }
}
character_event = {
    id = JD.60202
    desc = EVT_DESC_JD_60202
    picture = GFX_evt_china_rebel_general
    border = GFX_event_normal_frame_war
    is_triggered_only = yes
    hide_new = yes
    has_dlc = "Jade Dragon"
    option = {
        name = EVT_OPTA_JD_60202
        custom_tooltip = {
            text = rebel_general_will_invade_tt
        }
        hidden_effect = {
            character_event = {
                id = JD.60203
                days = 10
                random = 5
            }
        }
    }
}
character_event = {
    id = JD.60203
    is_triggered_only = yes
    hide_window = yes
    has_dlc = "Jade Dragon"
    trigger = {
        event_target:rebel_general = {
            is_alive = yes
        }
    }
    fail_trigger_effect = {
        character_event = {
            id = JD.60207
        }
    }
    immediate = {
        event_target:rebel_general = {
            war = {
                casus_belli = offmap_submission
                target = event_target:rebel_general_target
            }
            set_variable = {
                which = china_war_troop_quantity
                value = 10
            }
            set_variable = {
                which = china_war_target_match_mult
                value = 1
            }
            set_variable = {
                which = china_war_troop_quality
                value = 3
            }
            set_variable = {
                which = china_war_minimum_commander_martial
                value = 14
            }
            export_to_variable = {
                which = "rebel_general_martial"
                value = martial
            }
            divide_variable = {
                which = "rebel_general_martial"
                value = 4
            }
            change_variable = {
                which = "china_war_minimum_commander_martial"
                which = "rebel_general_martial"
            }
            china_war_modify_variables_by_century_effect = yes
            export_to_variable = {
                which = china_temp_troop_calc
                value = realm_levies_plus_allies
                who = FROM
            }
            divide_variable = {
                which = china_temp_troop_calc
                value = 500
            }
            multiply_variable = {
                which = china_temp_troop_calc
                which = china_war_target_match_mult
            }
            change_variable = {
                which = china_war_troop_quantity
                which = china_temp_troop_calc
            }
            any_courtier_or_vassal = {
                set_variable = {
                    which = china_war_minimum_commander_martial
                    which = PREV
                }
            }
            if = {
                limit = {
                    NOT = {
                        any_courtier_or_vassal = {
                            count = 5
                            martial = china_war_minimum_commander_martial
                        }
                    }
                }
                china_spawn_commander_effect = yes
                china_spawn_commander_effect = yes
                china_spawn_commander_effect = yes
                china_spawn_commander_effect = yes
                china_spawn_commander_effect = yes
            }
            1448 = {
                save_event_target_as = spawn_province
            }
            china_war_spawn_troops_no_disband_effect = yes
        }
    }
}
character_event = {
    id = JD.60204
    is_triggered_only = yes
    hide_window = yes
    trigger = {
        FROM = {
            has_title_flag = uses_temple_names_by_script
        }
        NOT = {
            has_character_flag = given_temple_name_by_script
        }
    }
    has_dlc = "Jade Dragon"
    immediate = {
        if = {
            limit = {
                has_character_flag = chinese_imperial_government_preserve
            }
            repeat_event = {
                id = JD.60212
                days = 1
            }
            break = yes
        }
        FROM = {
            save_event_target_as = temple_name_title
        }
        if = {
            limit = {
                NOT = {
                    dynasty = FROMFROM
                }
            }
            random_list = {
                1 = {
                    set_name = "高祖"  # Gaozu
                }
                1 = {
                    set_name = "太祖"  # Taizu
                }
                1 = {
                    set_name = "世祖"  # Shizu
                }
                1 = {
                    set_name = "昭祖"  # Zhaozu
                }
                1 = {
                    set_name = "靖祖"  # Jingzu
                }
                1 = {
                    set_name = "显祖"  # Xianzu
                }
                1 = {
                    set_name = "烈祖"  # Liezu
                }
                1 = {
                    set_name = "成祖"  # Chengzu
                }
            }
            set_character_flag = given_temple_name_by_script
            event_target:temple_name_title = {
                clear_flags_with_prefix = temple_name_
                clear_flags_with_prefix = china_name_
                random_list = {
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = tang_china
                                }
                            }
                        }
                        set_name = "唐朝"  # Tang Empire
                        set_title_flag = china_name_Tang
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = jin_china
                                }
                            }
                        }
                        set_name = "晋朝"  # Jin Empire
                        set_title_flag = china_name_Jin
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = wei_china
                                }
                            }
                        }
                        set_name = "魏朝"  # Wei Empire
                        set_title_flag = china_name_Wei
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = qi_china
                                }
                            }
                        }
                        set_name = "齐朝"  # Qi Empire
                        set_title_flag = china_name_Qi
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = zhou_china
                                }
                            }
                        }
                        set_name = "周朝"  # Zhou Empire
                        set_title_flag = china_name_Zhou
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = han_china
                                }
                            }
                        }
                        set_name = "汉朝"  # Han Empire
                        set_title_flag = china_name_Han
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = qin_china
                                }
                            }
                        }
                        set_name = "秦朝"  # Qin Empire
                        set_title_flag = china_name_Qin
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = yan_china
                                }
                            }
                        }
                        set_name = "燕朝"  # Yan Empire
                        set_title_flag = china_name_Yan
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = zhao_china
                                }
                            }
                        }
                        set_name = "赵朝"  # Zhao Empire
                        set_title_flag = china_name_Zhao
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = liao_china
                                }
                            }
                        }
                        set_name = "辽朝"  # Liao Empire
                        set_title_flag = china_name_Liao
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = yuan_china
                                }
                            }
                        }
                        set_name = "元朝"  # Yuan Empire
                        set_title_flag = china_name_Yuan
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = xia_china
                                }
                            }
                        }
                        set_name = "夏朝"  # Xia Empire
                        set_title_flag = china_name_Xia
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = qing_china
                                }
                            }
                        }
                        set_name = "清朝"  # Qing Empire
                        set_title_flag = china_name_Qing
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = dai_china
                                }
                            }
                        }
                        set_name = "代朝"  # Dai Empire
                        set_title_flag = china_name_Dai
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = cheng_china
                                }
                            }
                        }
                        set_name = "成朝"  # Cheng Empire
                        set_title_flag = china_name_Cheng
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = liang_china
                                }
                            }
                        }
                        set_name = "梁朝"  # Liang Empire
                        set_title_flag = china_name_Liang
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = song_china
                                }
                            }
                        }
                        set_name = "宋朝"  # Song Empire
                        set_title_flag = china_name_Song
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = ming_china
                                }
                            }
                        }
                        set_name = "明朝"  # Ming Empire
                        set_title_flag = china_name_Ming
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = shu_china
                                }
                            }
                        }
                        set_name = "蜀朝"  # Shu Empire
                        set_title_flag = china_name_Shu
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = wu_china
                                }
                            }
                        }
                        set_name = "吴朝"  # Wu Empire
                        set_title_flag = china_name_Wu
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = chu_china
                                }
                            }
                        }
                        set_name = "楚朝"  # Chu Empire
                        set_title_flag = china_name_Chu
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = yue_china
                                }
                            }
                        }
                        set_name = "越朝"  # Yue Empire
                        set_title_flag = china_name_Yue
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = yin_china
                                }
                            }
                        }
                        set_name = "殷朝"  # Yin Empire
                        set_title_flag = china_name_Yin
                    }
                    1 = {
                        trigger = {
                            NOT = {
                                offmap_china = {
                                    has_offmap_name = shun_china
                                }
                            }
                        }
                        set_name = "顺朝"  # Shun Empire
                        set_title_flag = china_name_Shun
                    }
                }
            }
            break = yes
        }
        if = {
            limit = {
                event_target:temple_name_title = {
                    has_title_flag = temple_name_Zhenzong
                    has_title_flag = temple_name_Renzong
                    has_title_flag = temple_name_Zhongzong
                    has_title_flag = temple_name_Yingzong
                    has_title_flag = temple_name_Shenzong
                    has_title_flag = temple_name_Zhezhong
                    has_title_flag = temple_name_Huizong
                    has_title_flag = temple_name_Qinzong
                    has_title_flag = temple_name_Xiaozong
                    has_title_flag = temple_name_Guangzong
                    has_title_flag = temple_name_Ningzong
                    has_title_flag = temple_name_Lizong
                    has_title_flag = temple_name_Duzong
                    has_title_flag = temple_name_Duanzong
                    has_title_flag = temple_name_Xuanzong
                    has_title_flag = temple_name_Suzong
                    has_title_flag = temple_name_Daizong
                    has_title_flag = temple_name_Muzong
                    has_title_flag = temple_name_Jingzong
                    has_title_flag = temple_name_Wenzong
                    has_title_flag = temple_name_Wuzong
                    has_title_flag = temple_name_Zhaozong
                    has_title_flag = temple_name_Xizong
                    has_title_flag = temple_name_Xuanzong
                    has_title_flag = temple_name_Shizong
                    has_title_flag = temple_name_Zhangzong
                    has_title_flag = temple_name_Ruizong
                    has_title_flag = temple_name_Dingzong
                    has_title_flag = temple_name_Xianzong
                    has_title_flag = temple_name_Chengzong
                    has_title_flag = temple_name_Mingzong
                    has_title_flag = temple_name_Jinzong
                    has_title_flag = temple_name_Yizong
                    has_title_flag = temple_name_Xiangzong
                    has_title_flag = temple_name_Huanzong
                    has_title_flag = temple_name_Chongzong
                    has_title_flag = temple_name_Daozong
                    has_title_flag = temple_name_Liezong
                    has_title_flag = temple_name_Aizong
                    has_title_flag = temple_name_Zhangzong
                    has_title_flag = temple_name_Dezong
                    has_title_flag = temple_name_Shengzong
                    has_title_flag = temple_name_Xingzong
                    has_title_flag = temple_name_Kangzong
                    has_title_flag = temple_name_Zhuangzong
                    has_title_flag = temple_name_Pingzong
                    has_title_flag = temple_name_Sizong
                    has_title_flag = temple_name_Anzong
                    has_title_flag = temple_name_Yangzong
                    has_title_flag = temple_name_Shangzong
                    has_title_flag = temple_name_Shunzong
                    has_title_flag = temple_name_Zhizong
                    has_title_flag = temple_name_Chuangzong
                    has_title_flag = temple_name_Shaozong
                    has_title_flag = temple_name_Gongzong
                    has_title_flag = temple_name_Yingzong
                }
            }
            event_target:temple_name_title = {
                clear_flags_with_prefix = temple_name_
            }
        }
        random_list = {
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Zhenzong
                        }
                    }
                }
                set_name = "真宗"  # Zhenzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Zhenzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Renzong
                        }
                    }
                }
                set_name = "仁宗"  # Renzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Renzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Zhongzong
                        }
                    }
                }
                set_name = "中宗"  # Zhongzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Zhongzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Yingzong
                        }
                    }
                }
                set_name = "英宗"  # Yingzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Yingzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Shenzong
                        }
                    }
                }
                set_name = "神宗"  # Shenzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Shenzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Zhezhong
                        }
                    }
                }
                set_name = "哲宗"  # Zhezhong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Zhezhong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Huizong
                        }
                    }
                }
                set_name = "徽宗"  # Huizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Huizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Qinzong
                        }
                    }
                }
                set_name = "钦宗"  # Qinzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Qinzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Xiaozong
                        }
                    }
                }
                set_name = "孝宗"  # Xiaozong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Xiaozong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Guangzong
                        }
                    }
                }
                set_name = "光宗"  # Guangzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Guangzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Ningzong
                        }
                    }
                }
                set_name = "宁宗"  # Ningzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Ningzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Lizong
                        }
                    }
                }
                set_name = "理宗"  # Lizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Lizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Duzong
                        }
                    }
                }
                set_name = "度宗"  # Duzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Duzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Duanzong
                        }
                    }
                }
                set_name = "端宗"  # Duanzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Duanzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Xuanzong
                        }
                    }
                }
                set_name = "宣宗"  # Xuanzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Xuanzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Suzong
                        }
                    }
                }
                set_name = "肃宗"  # Suzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Suzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Daizong
                        }
                    }
                }
                set_name = "岱宗"  # Daizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Daizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Muzong
                        }
                    }
                }
                set_name = "穆宗"  # Muzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Muzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Jingzong
                        }
                    }
                }
                set_name = "净宗"  # Jingzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Jingzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Wenzong
                        }
                    }
                }
                set_name = "文宗"  # Wenzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Wenzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Wuzong
                        }
                    }
                }
                set_name = "武宗"  # Wuzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Wuzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Zhaozong
                        }
                    }
                }
                set_name = "昭宗"  # Zhaozong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Zhaozong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Xizong
                        }
                    }
                }
                set_name = "熙宗"  # Xizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Xizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Xuanzong
                        }
                    }
                }
                set_name = "玄宗"  # Xuanzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Xuanzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Shizong
                        }
                    }
                }
                set_name = "世宗"  # Shizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Shizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Zhangzong
                        }
                    }
                }
                set_name = "章宗"  # Zhangzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Zhangzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Ruizong
                        }
                    }
                }
                set_name = "睿宗"  # Ruizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Ruizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Dingzong
                        }
                    }
                }
                set_name = "定宗"  # Dingzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Dingzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Xianzong
                        }
                    }
                }
                set_name = "显宗"  # Xianzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Xianzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Chengzong
                        }
                    }
                }
                set_name = "成宗"  # Chengzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Chengzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Mingzong
                        }
                    }
                }
                set_name = "明宗"  # Mingzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Mingzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Jinzong
                        }
                    }
                }
                set_name = "金宗"  # Jinzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Jinzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Yizong
                        }
                    }
                }
                set_name = "毅宗"  # Yizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Yizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Xiangzong
                        }
                    }
                }
                set_name = "襄宗"  # Xiangzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Xiangzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Huanzong
                        }
                    }
                }
                set_name = "桓宗"  # Huanzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Huanzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Chongzong
                        }
                    }
                }
                set_name = "崇宗"  # Chongzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Chongzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Daozong
                        }
                    }
                }
                set_name = "道宗"  # Daozong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Daozong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Liezong
                        }
                    }
                }
                set_name = "烈宗"  # Liezong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Liezong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Aizong
                        }
                    }
                }
                set_name = "哀宗"  # Aizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Aizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Zhangzong
                        }
                    }
                }
                set_name = "章宗"  # Zhangzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Zhangzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Dezong
                        }
                    }
                }
                set_name = "德宗"  # Dezong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Dezong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Shengzong
                        }
                    }
                }
                set_name = "圣宗"  # Shengzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Shengzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Xingzong
                        }
                    }
                }
                set_name = "兴宗"  # Xingzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Xingzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Kangzong
                        }
                    }
                }
                set_name = "康宗"  # Kangzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Kangzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Zhuangzong
                        }
                    }
                }
                set_name = "庄宗"  # Zhuangzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Zhuangzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Pingzong
                        }
                    }
                }
                set_name = "平宗"  # Pingzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Pingzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Sizong
                        }
                    }
                }
                set_name = "世宗"  # Sizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Sizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Anzong
                        }
                    }
                }
                set_name = "安宗"  # Anzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Anzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Yangzong
                        }
                    }
                }
                set_name = "炀宗"  # Yangzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Yangzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Shangzong
                        }
                    }
                }
                set_name = "殇宗"  # Shangzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Shangzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Shunzong
                        }
                    }
                }
                set_name = "顺宗"  # Shunzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Shunzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Zhizong
                        }
                    }
                }
                set_name = "智宗"  # Zhizong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Zhizong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Chuangzong
                        }
                    }
                }
                set_name = "传宗"  # Chuangzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Chuangzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Shaozong
                        }
                    }
                }
                set_name = "邵宗"  # Shaozong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Shaozong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Gongzong
                        }
                    }
                }
                set_name = "恭宗"  # Gongzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Gongzong
                }
                set_character_flag = given_temple_name_by_script
            }
            1 = {
                trigger = {
                    NOT = {
                        event_target:temple_name_title = {
                            has_title_flag = temple_name_Yingzong
                        }
                    }
                }
                set_name = "赢宗"  # Yingzong
                event_target:temple_name_title = {
                    set_title_flag = temple_name_Yingzong
                }
                set_character_flag = given_temple_name_by_script
            }
        }
    }
}
character_event = {
    id = JD.60205
    hide_window = yes
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    immediate = {
        if = {
            limit = {
                government = chinese_imperial_government
            }
            primary_title = {
                trigger_switch = {
                    on_trigger = has_title_flag
                    china_name_Tang = {
                        set_name = "唐"  # Tang
                    }
                    china_name_Jin = {
                        set_name = "晋"  # Jin
                    }
                    china_name_Wei = {
                        set_name = "魏"  # Wei
                    }
                    china_name_Qi = {
                        set_name = "齐"  # Qi
                    }
                    china_name_Zhou = {
                        set_name = "周"  # Zhou
                    }
                    china_name_Han = {
                        set_name = "汉"  # Han
                    }
                    china_name_Qin = {
                        set_name = "秦"  # Qin
                    }
                    china_name_Yan = {
                        set_name = "燕"  # Yan
                    }
                    china_name_Zhao = {
                        set_name = "赵"  # Zhao
                    }
                    china_name_Liao = {
                        set_name = "辽"  # Liao
                    }
                    china_name_Yuan = {
                        set_name = "元"  # Yuan
                    }
                    china_name_Xia = {
                        set_name = "夏"  # Xia
                    }
                    china_name_Qing = {
                        set_name = "清"  # Qing
                    }
                    china_name_Dai = {
                        set_name = "代"  # Dai
                    }
                    china_name_Cheng = {
                        set_name = "成"  # Cheng
                    }
                    china_name_Liang = {
                        set_name = "梁"  # Liang
                    }
                    china_name_Song = {
                        set_name = "宋"  # Song
                    }
                    china_name_Ming = {
                        set_name = "明"  # Ming
                    }
                    china_name_Shu = {
                        set_name = "蜀"  # Shu
                    }
                    china_name_Wu = {
                        set_name = "吴"  # Wu
                    }
                    china_name_Chu = {
                        set_name = "楚"  # Chu
                    }
                    china_name_Yue = {
                        set_name = "越"  # Yue
                    }
                    china_name_Yin = {
                        set_name = "殷"  # Yin
                    }
                    china_name_Shun = {
                        set_name = "顺"  # Shun
                    }
                }
                if = {
                    limit = {
                        has_dlc = "Conclave"
                        NOT = {
                            has_law = ze_administration_laws_2
                        }
                    }
                    trigger_switch = {
                        on_trigger = has_law
                        ze_administration_laws_1 = {
                            set_title_flag = has_ze_administration_laws_1
                        }
                        ze_administration_laws_0 = {
                            set_title_flag = has_ze_administration_laws_0
                        }
                    }
                    add_law = {
                        law = ze_administration_laws_2
                        cooldown = no
                        opinion_effect = no
                    }
                }
                if = {
                    limit = {
                        NOT = {
                            has_dlc = "Conclave"
                        }
                        NOT = {
                            has_law = imperial_administration
                        }
                    }
                    if = {
                        limit = {
                            has_law = feudal_administration
                        }
                        set_title_flag = has_feudal_administration
                    }
                    add_law = {
                        law = imperial_administration
                        cooldown = no
                        opinion_effect = no
                    }
                }
            }
        }
        any_playable_ruler = {
            limit = {
                government = chinese_imperial_government
            }
            primary_title = {
                trigger_switch = {
                    on_trigger = has_title_flag
                    china_name_Tang = {
                        set_name = "唐"  # Tang
                    }
                    china_name_Jin = {
                        set_name = "晋"  # Jin
                    }
                    china_name_Wei = {
                        set_name = "魏"  # Wei
                    }
                    china_name_Qi = {
                        set_name = "齐"  # Qi
                    }
                    china_name_Zhou = {
                        set_name = "周"  # Zhou
                    }
                    china_name_Han = {
                        set_name = "汉"  # Han
                    }
                    china_name_Qin = {
                        set_name = "秦"  # Qin
                    }
                    china_name_Yan = {
                        set_name = "燕"  # Yan
                    }
                    china_name_Zhao = {
                        set_name = "赵"  # Zhao
                    }
                    china_name_Liao = {
                        set_name = "辽"  # Liao
                    }
                    china_name_Yuan = {
                        set_name = "元"  # Yuan
                    }
                    china_name_Xia = {
                        set_name = "夏"  # Xia
                    }
                    china_name_Qing = {
                        set_name = "清"  # Qing
                    }
                    china_name_Dai = {
                        set_name = "代"  # Dai
                    }
                    china_name_Cheng = {
                        set_name = "成"  # Cheng
                    }
                    china_name_Liang = {
                        set_name = "梁"  # Liang
                    }
                    china_name_Song = {
                        set_name = "宋"  # Song
                    }
                    china_name_Ming = {
                        set_name = "明"  # Ming
                    }
                    china_name_Shu = {
                        set_name = "蜀"  # Shu
                    }
                    china_name_Wu = {
                        set_name = "吴"  # Wu
                    }
                    china_name_Chu = {
                        set_name = "楚"  # Chu
                    }
                    china_name_Yue = {
                        set_name = "越"  # Yue
                    }
                    china_name_Yin = {
                        set_name = "殷"  # Yin
                    }
                    china_name_Shun = {
                        set_name = "顺"  # Shun
                    }
                }
                if = {
                    limit = {
                        has_dlc = "Conclave"
                        NOT = {
                            has_law = ze_administration_laws_2
                        }
                    }
                    trigger_switch = {
                        on_trigger = has_law
                        ze_administration_laws_1 = {
                            set_title_flag = has_ze_administration_laws_1
                        }
                        ze_administration_laws_0 = {
                            set_title_flag = has_ze_administration_laws_0
                        }
                    }
                    add_law = {
                        law = ze_administration_laws_2
                        cooldown = no
                        opinion_effect = no
                    }
                }
                if = {
                    limit = {
                        NOT = {
                            has_dlc = "Conclave"
                        }
                        NOT = {
                            has_law = imperial_administration
                        }
                    }
                    if = {
                        limit = {
                            has_law = feudal_administration
                        }
                        set_title_flag = has_feudal_administration
                    }
                    add_law = {
                        law = imperial_administration
                        cooldown = no
                        opinion_effect = no
                    }
                }
            }
        }
    }
}
character_event = {
    id = JD.60206
    hide_window = yes
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    immediate = {
        if = {
            limit = {
                government = chinese_imperial_government
            }
            primary_title = {
                trigger_switch = {
                    on_trigger = has_title_flag
                    china_name_Tang = {
                        set_name = "唐朝"  # Tang Empire
                    }
                    china_name_Jin = {
                        set_name = "晋朝"  # Jin Empire
                    }
                    china_name_Wei = {
                        set_name = "魏朝"  # Wei Empire
                    }
                    china_name_Qi = {
                        set_name = "齐朝"  # Qi Empire
                    }
                    china_name_Zhou = {
                        set_name = "周朝"  # Zhou Empire
                    }
                    china_name_Han = {
                        set_name = "汉朝"  # Han Empire
                    }
                    china_name_Qin = {
                        set_name = "秦朝"  # Qin Empire
                    }
                    china_name_Yan = {
                        set_name = "燕朝"  # Yan Empire
                    }
                    china_name_Zhao = {
                        set_name = "赵朝"  # Zhao Empire
                    }
                    china_name_Liao = {
                        set_name = "辽朝"  # Liao Empire
                    }
                    china_name_Yuan = {
                        set_name = "元朝"  # Yuan Empire
                    }
                    china_name_Xia = {
                        set_name = "夏朝"  # Xia Empire
                    }
                    china_name_Qing = {
                        set_name = "清朝"  # Qing Empire
                    }
                    china_name_Dai = {
                        set_name = "代朝"  # Dai Empire
                    }
                    china_name_Cheng = {
                        set_name = "成朝"  # Cheng Empire
                    }
                    china_name_Liang = {
                        set_name = "梁朝"  # Liang Empire
                    }
                    china_name_Song = {
                        set_name = "宋朝"  # Song Empire
                    }
                    china_name_Ming = {
                        set_name = "明朝"  # Ming Empire
                    }
                    china_name_Shu = {
                        set_name = "蜀朝"  # Shu Empire
                    }
                    china_name_Wu = {
                        set_name = "吴朝"  # Wu Empire
                    }
                    china_name_Chu = {
                        set_name = "楚朝"  # Chu Empire
                    }
                    china_name_Yue = {
                        set_name = "越朝"  # Yue Empire
                    }
                    china_name_Yin = {
                        set_name = "殷朝"  # Yin Empire
                    }
                    china_name_Shun = {
                        set_name = "顺朝"  # Shun Empire
                    }
                }
                trigger_switch = {
                    on_trigger = has_title_flag
                    has_ze_administration_laws_1 = {
                        add_law = {
                            law = ze_administration_laws_1
                            cooldown = no
                            opinion_effect = no
                        }
                    }
                    has_ze_administration_laws_0 = {
                        add_law = {
                            law = ze_administration_laws_0
                            cooldown = no
                            opinion_effect = no
                        }
                    }
                    has_feudal_administration = {
                        add_law = {
                            law = feudal_administration
                            cooldown = no
                            opinion_effect = no
                        }
                    }
                }
            }
        }
        any_playable_ruler = {
            limit = {
                government = chinese_imperial_government
            }
            primary_title = {
                trigger_switch = {
                    on_trigger = has_title_flag
                    china_name_Tang = {
                        set_name = "唐朝"  # Tang Empire
                    }
                    china_name_Jin = {
                        set_name = "晋朝"  # Jin Empire
                    }
                    china_name_Wei = {
                        set_name = "魏朝"  # Wei Empire
                    }
                    china_name_Qi = {
                        set_name = "齐朝"  # Qi Empire
                    }
                    china_name_Zhou = {
                        set_name = "周朝"  # Zhou Empire
                    }
                    china_name_Han = {
                        set_name = "汉朝"  # Han Empire
                    }
                    china_name_Qin = {
                        set_name = "秦朝"  # Qin Empire
                    }
                    china_name_Yan = {
                        set_name = "燕朝"  # Yan Empire
                    }
                    china_name_Zhao = {
                        set_name = "赵朝"  # Zhao Empire
                    }
                    china_name_Liao = {
                        set_name = "辽朝"  # Liao Empire
                    }
                    china_name_Yuan = {
                        set_name = "元朝"  # Yuan Empire
                    }
                    china_name_Xia = {
                        set_name = "夏朝"  # Xia Empire
                    }
                    china_name_Qing = {
                        set_name = "清朝"  # Qing Empire
                    }
                    china_name_Dai = {
                        set_name = "代朝"  # Dai Empire
                    }
                    china_name_Cheng = {
                        set_name = "陈朝"  # Cheng Empire
                    }
                    china_name_Liang = {
                        set_name = "梁朝"  # Liang Empire
                    }
                    china_name_Song = {
                        set_name = "宋朝"  # Song Empire
                    }
                    china_name_Ming = {
                        set_name = "明朝"  # Ming Empire
                    }
                    china_name_Shu = {
                        set_name = "蜀朝"  # Shu Empire
                    }
                    china_name_Wu = {
                        set_name = "吴朝"  # Wu Empire
                    }
                    china_name_Chu = {
                        set_name = "楚朝"  # Chu Empire
                    }
                    china_name_Yue = {
                        set_name = "越朝"  # Yue Empire
                    }
                    china_name_Yin = {
                        set_name = "殷朝"  # Yin Empire
                    }
                    china_name_Shun = {
                        set_name = "顺朝"  # Shun Empire
                    }
                }
                trigger_switch = {
                    on_trigger = has_title_flag
                    has_ze_administration_laws_1 = {
                        add_law = {
                            law = ze_administration_laws_1
                            cooldown = no
                            opinion_effect = no
                        }
                    }
                    has_ze_administration_laws_0 = {
                        add_law = {
                            law = ze_administration_laws_0
                            cooldown = no
                            opinion_effect = no
                        }
                    }
                    has_feudal_administration = {
                        add_law = {
                            law = feudal_administration
                            cooldown = no
                            opinion_effect = no
                        }
                    }
                }
            }
        }
    }
}
character_event = {
    id = JD.60207
    desc = EVT_DESC_JD_60207
    picture = GFX_evt_china_rebel_general
    border = GFX_event_normal_frame_war
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    immediate = {
        event_target:rebel_general_title = {
            holder_scope = {
                any_courtier = {
                    death = {
                        death_reason = death_executed_by_chinese_emperor
                    }
                }
            }
            activate_title = {
                title = THIS
                status = no
            }
            destroy_landed_title = THIS
        }
    }
    option = {
        name = EVT_OPTA_JD_60207
    }
}
narrative_event = {
    id = JD.60208
    title = NEWS_FROM_CHINA
    picture = GFX_evt_china_rebel_general
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    desc = {
        text = EVTDESC_JD_60208_A
        trigger = {
            event_target:chinese_invasion_target = {
                character = ROOT
            }
        }
    }
    desc = {
        text = EVTDESC_JD_60208_B
        trigger = {
            NOT = {
                event_target:chinese_invasion_target = {
                    character = ROOT
                }
            }
        }
    }
    option = {
        name = {
            text = EVTOPTA_JD_10102_A_brave
            trigger = {
                trait = brave
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_craven
            trigger = {
                trait = craven
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_pious
            trigger = {
                is_pious_trigger = yes
            }
        }
        name = {
            text = EVTOPTA_JD_10102_A_neutral
            trigger = {
                NOT = {
                    trait = craven
                }
                NOT = {
                    trait = brave
                }
                NOT = {
                    is_pious_trigger = yes
                }
            }
        }
        trigger = {
            event_target:chinese_invasion_target = {
                character = ROOT
            }
        }
    }
    option = {
        name = EVT_OPTA_JD_60208
        event_target:chinese_invasion_target = {
            show_portrait = yes
        }
        trigger = {
            NOT = {
                event_target:chinese_invasion_target = {
                    character = ROOT
                }
            }
        }
    }
}
narrative_event = {
    id = JD.60209
    title = NEWS_FROM_CHINA
    picture = GFX_evt_china_rebel_general
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    desc = {
        text = EVTDESC_JD_60209_A
        trigger = {
            FROM = {
                has_character_flag = pretender_chinese_empire_destroyed_inheritance
            }
        }
    }
    desc = {
        text = EVTDESC_JD_60209_B
        trigger = {
            NOT = {
                FROM = {
                    has_character_flag = pretender_chinese_empire_destroyed_inheritance
                }
            }
        }
    }
    option = {
        name = EVT_OPTA_JD_60209
    }
}
character_event = {
    id = JD.60210
    is_triggered_only = yes
    hide_window = yes
    has_dlc = "Jade Dragon"
    trigger = {
        government = chinese_imperial_government
        current_heir = {
            NOR = {
                culture_group = chinese_group
                culture = khitan
                culture = tangut
                culture = jurchen
            }
        }
    }
    immediate = {
        if = {
            limit = {
                primary_title = {
                    has_title_flag = rebel_general_title
                }
            }
            primary_title = {
                ROOT = {
                    set_character_flag = pretender_chinese_empire_destroyed_inheritance
                    any_player = {
                        limit = {
                            OR = {
                                AND = {
                                    has_offmap_news_enabled = offmap_china
                                    is_within_diplo_range = ROOT
                                }
                                liege = {
                                    character = ROOT
                                }
                            }
                        }
                        narrative_event = {
                            id = JD.60209
                        }
                    }
                    any_vassal = {
                        set_defacto_liege = THIS
                    }
                    any_demesne_title = {
                        limit = {
                            higher_tier_than = COUNT
                            NOT = {
                                has_title_flag = pretender_chinese_empire
                            }
                        }
                        destroy_landed_title = THIS
                    }
                    any_demesne_title = {
                        limit = {
                            tier = COUNT
                        }
                        location = {
                            create_character = {
                                religion = THIS
                                culture = THIS
                                dynasty = actually_culture
                                age = 33
                                random_traits = yes
                                female = no
                            }
                            new_character = {
                                save_event_target_as = pretender_chinese_empire_new_character
                                PREVPREV = {
                                    usurp_title_plus_barony_if_unlanded = {
                                        target = event_target:pretender_chinese_empire_new_character
                                        type = invasion
                                    }
                                }
                            }
                        }
                    }
                }
                activate_title = {
                    title = THIS
                    status = no
                }
                destroy_landed_title = THIS
            }
        }
        else = {
            if = {
                limit = {
                    OR = {
                        ai = no
                        current_heir = {
                            is_landed = no
                        }
                    }
                }
                current_heir = {
                    set_character_flag = chinese_imperial_government_preserve
                }
            }
            else = {
                primary_title = {
                    clr_title_flag = pretender_chinese_empire
                    clr_title_flag = uses_temple_names_by_script
                    clear_flags_with_prefix = temple_name_
                    clear_flags_with_prefix = china_name_
                    set_name = "{Root.Capital.GetName} Empire"
                }
            }
        }
    }
}
narrative_event = {
    id = JD.60211
    title = NEWS_FROM_CHINA
    desc = EVTDESC_JD_60211
    picture = GFX_evt_china_rebel_general
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    option = {
        name = EVT_OPTA_JD_60211
        trigger = {
            FROM = {
                is_liege_of = ROOT
            }
        }
    }
    option = {
        name = EVT_OPTB_JD_60211
        trigger = {
            NOT = {
                FROM = {
                    is_liege_of = ROOT
                }
            }
        }
    }
}
character_event = {
    id = JD.60212
    desc = EVT_DESC_JD_60212
    picture = GFX_evt_china_rebel_general
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    option = {
        name = EVT_OPTA_JD_60212
        culture = FROMFROM
        clr_character_flag = chinese_imperial_government_preserve
        repeat_event = {
            id = JD.60204
        }
    }
    option = {
        name = EVT_OPTB_JD_60212
        ai_chance = {
            factor = 0
        }
        primary_title = {
            clr_title_flag = pretender_chinese_empire
            clr_title_flag = uses_temple_names_by_script
            clear_flags_with_prefix = temple_name_
            clear_flags_with_prefix = china_name_
            set_name = "{Root.Capital.GetName} Empire"
        }
        if = {
            limit = {
                religion_group = muslim
            }
            set_government_type = muslim_government
        }
        else_if = {
            limit = {
                culture_group = tibetan_group
                OR = {
                    religion = bon
                    religion = buddhist
                }
                higher_tier_than = BARON
            }
            set_government_type = theocratic_feudal_government
        }
        else = {
            set_government_type = feudal_government
        }
        clr_character_flag = chinese_imperial_government_preserve
    }
}
narrative_event = {
    id = JD.60400
    title = NEWS_FROM_CHINA
    picture = GFX_evt_china_civil_war
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    is_triggered_only = yes
    desc = {
        text = EVTDESC_JD_60400_A
        trigger = {
            event_target:invasion_of_china_attacker = {
                character = ROOT
            }
        }
    }
    desc = {
        text = EVTDESC_JD_60400_B
        trigger = {
            NOT = {
                event_target:invasion_of_china_attacker = {
                    character = ROOT
                }
            }
        }
    }
    has_dlc = "Jade Dragon"
    option = {
        name = {
            text = EVT_OPTA_JD_60400
            trigger = {
                event_target:invasion_of_china_attacker = {
                    character = ROOT
                }
            }
        }
        name = {
            text = EVT_OPTB_JD_60400
            trigger = {
                NOT = {
                    event_target:invasion_of_china_attacker = {
                        character = ROOT
                    }
                }
            }
        }
        show_portrait = event_target:invasion_of_china_claimant
    }
}
narrative_event = {
    id = JD.60401
    title = NEWS_FROM_CHINA
    desc = EVTDESC_JD_60401
    picture = GFX_evt_china_civil_war
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    immediate = {
        offmap_china = {
            set_offmap_flag = no_policy_news
            set_policy = china_open
            log = "-------------------------------------"
            log = "China Policy Logging:"
            log = "Chinas new Policy is now OPEN"
            log = "-------------------------------------"
            clr_offmap_flag = no_policy_news
        }
    }
    option = {
        name = EVT_OPT_JD_60401
    }
}
narrative_event = {
    id = JD.60402
    title = NEWS_FROM_CHINA
    desc = EVTDESC_JD_60402
    picture = GFX_evt_china_civil_war
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    option = {
        name = EVT_OPT_JD_60402
        show_portrait = event_target:invasion_of_china_claimant
    }
}
narrative_event = {
    id = JD.60403
    title = NEWS_FROM_CHINA
    desc = EVTDESC_JD_60403
    picture = GFX_evt_china_civil_war
    portrait = offmap_china
    window = EventWindowOffmap
    background = GFX_event_window_news_from_china
    is_triggered_only = yes
    has_dlc = "Jade Dragon"
    option = {
        name = EVT_OPTA_JD_60403
        trigger = {
            NOT = {
                FROM = {
                    character = ROOT
                }
            }
        }
        show_portrait = event_target:invasion_of_china_claimant
    }
    option = {
        name = EVT_OPTB_JD_60403
        trigger = {
            FROM = {
                character = ROOT
            }
        }
        show_portrait = event_target:invasion_of_china_claimant
    }
}